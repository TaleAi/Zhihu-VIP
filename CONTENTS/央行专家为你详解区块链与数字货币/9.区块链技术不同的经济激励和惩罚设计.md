## 9.区块链技术不同的经济激励和惩罚设计

> 本节为《区块链技术的激励相容：基于博弈论的经济分析》第二篇（共两篇），作者认为通过激励相容的算法规则和相关契约安排，区块链明确各方的经济利益，充分调动各方的积极性，使分布式协同作业真正成为可能。


区块链技术不同的经济激励和惩罚设计
=================


**工作量证明机制（PoW）的激励相容**


Nakamoto（中本聪）提出的工作量证明机制（PoW）同时包含了分布式共识的激励和惩罚机制。


**（一）激励机制**


如前述所言，区块链是一个公共可见的账本，用来记录交易的历史信息。当一笔新的资产交易被创建时，资产转出方须通过签名脚本来证明自己是资产的合法使用者，并且指定输出脚本来限制未来对本交易的使用者（资产收入方）。如果是合法创建并签名的，则该笔交易现在就是有效的，它将被广播到区块链网络并被传送，每一个收到交易的节点将会首先验证该交易，确保只有有效的交易才会在网络中传播，而无效的交易将会在第一个节点处被废弃，直至抵达挖矿节点。


挖矿节点在验证交易后，会将这些交易添加到自己的内存池中，构建新的区块。在 PoW 机制，矿工们接着通过反复尝试求解一种基于哈希算法的数学难题来竞争获得记账权，具体而言，矿工不断更换区块头的填充随机数并计算这个区块头信息的哈希值，看其是否小于当前目标值。如果小于，则成功「出块」，随后矿工将这个区块发给它的所有相邻节点。这些节点在接收后进行一系列的检查标准去验证区块的正确性。检查的标准包括区块的数据结构和区块包含的交易合法有效；区块头的哈希值小于目标难度（确认包含足够的工作量证明）等。一旦一个节点验证了一个新的区块，它就会将新的区块连接到累积了最大工作量证明的区块链中，矿工挖矿成功。


在上述过程中，矿工获得两方面奖励：一是代币奖励。矿工构建的新区块中的第一笔交易是一笔特殊交易，称为创币交易或者 Coinbase 交易。矿工挖矿成功后，将获得这笔新创造的加密代币。在比特币网络，每隔 10 分钟将一个新的区块添加至链上，每添加一个区块可以获得 50 枚比特币作为奖励（每四年减半）。二是记账决策权与交易手续费。矿工拥有记账决策权，有权决定将哪些交易添加至新构建的区块，并对收录在区块内的所有交易收取手续费。


**（二）惩罚机制**


通过惩罚设计，PoW 设置了两道门槛：第一道门槛设在矿工竞争记账权的时候，使得矿工不能随便「发言」（新增区块）。一方面，矿工为获得记账权，须不断求解哈希难题，因此付出「不菲」的成本，这一成本是沉没成本，只要矿工想参与「发言」，那么无论他最终能否成功「发言」，他均必须付出这一笔建言成本；另一方面，由于哈希难题的验证要比求解来得简单，对新出区块的验证成本微乎其微，因此只要矿工一错误「发言」（如交易无效、格式不符等），就会很快地被其他节点检测出来废弃掉，他之前付出的建言成本相当于对他的惩罚。


第二道门槛则设在区块被成功添加区块链后的修改，使得矿工不能随意更改区块链。在比特币网络，每 2016 个区块(大约两周)后，所有客户端把新区块的实际数目与目标数量相比较，并且按照差异的百分比调整目标哈希值，来增加（或减少）产生区块的难度，确保每 10 分钟 1 块的恒定出块速度。挖矿难度值的提高，增加了攻击的成本。攻击者如果要构造出一条比真实区块链更长的秘密区块链，需要在比特币网络产出 6 个区块的同时秘密产出 7 个区块。


截至 2018 年 2 月，专业的比特币挖矿机器（以 Bitmain 生产的 AntMiner S9 为例）价格为 2700 美元，这台矿机以 2017 年 2 月 27 日为基准可挖 0.0012 枚比特币。一台 AntMiner S9 每天耗电 33 度，按照居民用电价格计算，大概每天的电费是 2.6 美元。假定 AntMiner S9 的折旧年限为 3 年，可推算每天固定资产折旧为 2700/（365\*3）=2.5 美元，加上耗电费用 2.6 美元，得到挖出一枚比特币的生产成本为(2.5+2.6)/0.0012=4250 美元。那么，无论攻击成功与否，攻击者都要付出 4250\*7=29750 美元，约 3 万美元的成本，而且这一成本随着挖矿难度的增加不断上升，再加上与诚实者的算力竞争，显然对算力提出了巨大的要求：只有掌握了比特币全网 51% 算力的攻击者，才可以用这些算力来重新计算已经确认过的区块。


上述两道门槛使得无论是新增还是更改区块，均要付出不菲的成本，尤其是对后者的要求更为苛刻，这就是 Nakamoto 面对「拜占庭将军问题」的全新思路。从某种意义上来说，PoW 机制的「工作量」相当于现代资产交易或拍卖的保证金制度，免除了随意报价，同时还确保了比特币各区块哈希值的唯一性及难以篡改，这正是 PoW 这一机制设计精巧的地方。


**权益证明机制（PoS）的激励相容**


**（一）自私挖矿攻击和 P+Epsilon 攻击**


PoW 机制存在着缺陷。首先，在性能上， PoW 的挖矿要耗费算力资源，且随着算力竞争，挖矿难度值不断提高，每 10 分钟 1 块的恒定出块速度制约交易性能。其次，在安全性上，PoW 存在自私挖矿攻击和 P+Epsilon 攻击的隐患。


自私挖矿攻击由美国康奈尔大学两位学者 Ittay Eyal（伊泰·艾尔）和 Emin Gun Sirer（冈塞尔）提出，它是指，自私矿工不公开挖到的块，产生秘密分支，这时候诚实矿工还会基于较短的公开分支挖矿，当自私矿工选择性地公开秘密分支上的区块，将导致诚实矿工抛弃掉较短的公开分支，基于秘密分支计算最新的块，由此就浪费了诚实矿工花费在公开分支的算力，使得自私矿池获得高于全网算力比例的收益。当自私矿工所在的矿池占总网算力的 1/3 时，其获得的收益会大于相对算力，于是理性矿工会源源不断地加入自私矿池，最终导致矿池算力超过总网络的 50%。


P+Epsilon 攻击由以太坊创始人 Vitalik Buterin 提出，它是一种贿赂攻击者模型，即攻击者进入系统，以可信的预算贿赂其他矿工们参与攻击，但事后却无须付出任何成本。以表 1 为例，假定攻击者给予矿工们一个可信的贿赂预期：当其他人选择「协作」时，如果你选择「攻击」，我将给予你比选择「协作」更高的收益，通过这样的贿赂，其他人选择「协作」，我选择「攻击」的收益由 6 变为 8+ε，见表 4。此时的纳什均衡解就变为（攻击，攻击），即所有矿工均选择「攻击」，各自的收益均为-1，事后，攻击者没有付出成本，因为所有人都选择了攻击，攻击者不用兑现贿赂承诺。也就是说，攻击者只要以可信的预算和承诺（例如将资金锁定在智能合约），就可零成本地实现对系统的攻击。


![img](https://pic3.zhimg.com/v2-40c2ae9de857887c756b8efc3f411e40.webp)

**（二）PoS 机制降低了攻击的经济激励**


PoS 机制在理论上可以克服上述缺陷。其一，在 PoS 机制，节点获得区块创建权的概率取决于该节点在系统中所占有的权益比例的大小，不耗费算力，因此就不存在自私挖矿攻击的问题；其二，针对 P+Epsilon 攻击，Vitalik Buterin 提出可以在 PoS 机制中引入严厉的惩罚予以预防，即要求矿工们提取一定比例的私人财富（或称权益）作为抵押物，投注于未来的区块中，随后根据投注的情况进行处罚，比如，如果事后可以明确地证明一个特定的区块是有问题的，那么就对这个区块的投注者进行最大限度的惩罚，这就改变了 P+Epsilon 攻击时矿工的预期收益，使他们一旦在真实链上投注了自己的权益，就会有更大的动力继续在真实链上工作，而不是参与作恶，同时又大大增加了攻击者的贿赂预算。理论上，攻击者需要拥有 51% 的权益（数字代币），才有可能发起成功的攻击，无疑，倘若攻击成功，攻击者自身的权益也会受到很大的损失，因此就降低了发起 P+Epsilon 攻击的激励。


**（三） PoS 机制可引入经济惩罚来解决「利益无关者」攻击**


「利益无关者攻击」（Nothing at the Stake Attack）是指，由于 PoS 机制不需要耗费算力，因此矿工在伪造链上挖矿无须成本，但一旦伪造链被确认时，则会获得收益，这就会激励即便是诚实的矿工也可能会在伪造链上挖矿，尤其是权益越少的矿工，这种「投机」的心态越强，因为虽然他们知道这种攻击行为会造成整个系统的价值降低，但他们的权益很少，他们并不在乎，而当少数人「积少成多」时，就会对系统的整体安全性带来隐患。「利益无关者攻击」也称为平凡人悲剧（Tragedy of the Commons）。


对此，以太坊的 Casper 权益证明机制引入了名为 Slasher 的惩罚机制，即如果有人尝试了攻击，其他人发现了可以公布证据，系统将对这个人进行惩罚。由此，就抑制了矿工在伪造链上挖矿的经济激励，有效预防「利益无关者攻击」。


**（四）PoS 机制的实践**


PeerCoin 最早提出并实现了 PoS 共识协议。PeerCoin 没有完全抛弃 PoW，每个节点有自己的 PoW 难度值，币龄（Coinage）是该难度值的计算参数。币龄越高，则 PoW 难度越低，越容易计算出满足难度的哈希值。PoS 一般需要用户时刻在线，对应用带来了很大的挑战。为了解决这个问题，衍生出了 DPoS（Delegated Proof of Stake）共识，其核心思想是从先从全网节点中选出部分节点，保证这些节点的有效性，然后在该子节点集合内进行 PoS 共识。BitShares 是第一个采用 DPoS 的区块链。在 BitShares 中，全网节点投票选出 101 名代表，来负责区块的生成。


**总结与展望**


基于不同的经济激励和惩罚设计，PoW 机制和 PoS 机制构建了一个激励相容的开放式环境，让众多互不相识的参与者自愿参与，一起对区块的账本信息进行验证、确认和达成共识，形成统一的交易账本，从而可以在无需第三方机构的情况下实现资产的确权、交易和转移。目前，PoW 机制与 PoS 机制孰优孰劣，尚未有定论。比如，有人就认为，PoW 机制的资源耗费不是无意义的，恰恰是「真金白银」的投入，才凸显区块链系统的价值与可信。


在理论上，共识机制的研究成果正不断丰富，比如在 PoW 机制方面，康奈尔大学 Rafael Pass 提出 Thunderella 算法，使状态机与同步协议无异，不仅可以实现快速的异步处理，还可以在异常时启动回滚机制，同时实现了拜占庭容错和交易瞬间响应；在 PoS 机制方面，研究者们提出了各种算法，如康奈尔大学的 Elaine Shi 等提出的基于 Sleepy Model 的 PoS 共识，Silvio Micali 等提出的 Algorand 协议，爱丁堡大学 Aggelos Kiayias 等提出的 Ouroboros 算法等；Krzysztof Pietrzak 和 Bram Cohen 则提出了一种新的取代 PoW 的共识机制，他们称之为空间证明机制（Proof of Space）。这些共识机制和安全模型仍需在实践上进一步检验。



> 姚前为中国人民银行数字货币研究所所长，本文得到国家重点研发计划（批准号：2016YFB0800600）和 SFI（上海新金融研究院）资助，本文仅代表个人学术观点，与任何机构无关。


备案号:YX01Y3XEq9mjDYlyp


###### 2019-08-29 12:26

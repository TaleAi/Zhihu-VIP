## 18.让你的数据会说话：数据透视表入门
很多人用了 Excel 多年却不知道数据透视表为何物，不知道它到底有什么神通，究竟能干些什么事情。


简单来说，可以把数据透视表理解成一款基于 Excel 的小型数据库软件，可以对数据表格进行分类、筛先、计算，从各个不同的维度对数据进行分析的一个工具。


文字描述是不会带来直观的体验，我们就从最简单的例子开始，为大家打开数据透视表的大门。


![img](https://pic2.zhimg.com/v2-bfc2eab329227ea8e32e215606f40054.webp)

这是一张公司各部门员的绩效考核表，这个表可以很大，有几百上千条数据，我们只需要截取部门来说明问题。


![img](https://pic2.zhimg.com/v2-97be7ebb82856965becfad1b0cdd0a09.webp)

在「插入」选项卡上选择「数据透视表」，也可以依次按 Alt，D，P 键。


![img](https://pic4.zhimg.com/v2-d84e9d327dd47a7ea4dbdfe4026c67b1.webp)

弹出「创建数据透视表」窗口，在「表/区域」会自动选中当前表格的数据源。如果选择区域不符合你的需求，可以右侧的向上箭头，重新选择。也可以手动录入起始单元格的行列号。


「选择放置数据透视表的位置」一栏，根据你的需要，多数情况下选择「新工作表」以免误操作破坏数据源。


![img](https://pic4.zhimg.com/v2-86428ec5cb707fe1529bad477d8f641b.webp)

右侧「透视数据字段」窗口，就是我们用来设置字段的地方。注意一下左侧的空表和表头，一共有四个区域，分别有文字显示：「将报表筛选字段拖至此处」、「将行字段拖至此处」、「将列字段拖至此处」、「将值字段拖至此处」。这 4 个部分和右侧下方的四个部门是一一对应的。也就是说你用鼠标把字段拖动到左侧的空表中和拖到下面的四个窗口，操作结果都是一样的。


下面我们来看看具体是怎么操作的。


![img](https://pic2.zhimg.com/v2-c49f76b496b983da3ea23e7af1386e07.webp)

用鼠标拖动「部门」到行区域，拖动「姓名」到值区域。这时左侧的数据透视就变了，显示的是部门和部门的人员数量汇总。不用任何函数公式，就实现了汇总。


![img](https://pic3.zhimg.com/v2-3d8299e3b63a523b4d66c7dfb8b5fc0a.webp)

把学历字段拖到行区域里，就会统计出不同学历的员工人数，同样的方法也可以统计出不同工龄的员工数量。


![img](https://pic2.zhimg.com/v2-5959663b8c3c70161f9b443f41399997.webp)

把「部门」拖到行区域，「绩效考核分数」拖到值区域，这时候透视表又变了，显示的是部门分数总和。


![img](https://pic3.zhimg.com/v2-4d32fe00179869baedd06683ade13fa8.webp)

点击值区域「求和项：绩效考核分数」右边的黑色三角形弹出菜单，选择「值字段设置」。


![img](https://pic4.zhimg.com/v2-babe205f8a2a466602f3eef5c7d68b61.webp)

弹出「值字段设置」窗口，在「计算类型」选择「平均值」，点击确定。


![img](https://pic4.zhimg.com/v2-a2b09f3a4d3d1664eb2a4de60020a6e5.webp)

透视表的值就从部门总分变成了部门平均分。


![img](https://pic4.zhimg.com/v2-2c6c276c1187b4b30874b15a5186552b.webp)

在计算类型里还有很多其他类型，比如最大最小值以及其他方差等一些数据分析中要用到的类型。这些都不需要输入函数公式，选择了类型透视表会自行汇总。


看出透视表的厉害了吧？还没有完，以上是数值的统计汇总功能，我们继续看其他功能。


![img](https://pic1.zhimg.com/v2-352a1cba22ce491106dd2715392b0973.webp)

把「绩效考核分数」和「姓名」都拖到行区域，这里透视表显示的是不同分数有哪些员工。


![img](https://pic4.zhimg.com/v2-afa29ad785ffdf456a6bbb184196f025.webp)

鼠标定位到行区域，按右键，在弹出菜单中选择「组合」。


![img](https://pic4.zhimg.com/v2-b382036416e38bb2f70b9f827241c769.webp)

步长改为 5，点击确定。


![img](https://pic1.zhimg.com/v2-b930a66d607b4138839702e6ee127f0e.webp)

再看透视表就变成了按分数段显示了，不同的分数段的员工姓名分别显示。


![img](https://pic4.zhimg.com/v2-e1b9e661bd83d61a14258c78ef22c6b5.webp)

把姓名字段从行区域拖到值区域，这时透视表显示的是不同分数段下的员工数量汇总。


数据的「组合」功能非常强大，比如日期可以按 7 组合成周，30 组合成月，只需要更改步长，想从什么维度去看都可以。


![img](https://pic4.zhimg.com/v2-643918a00c48c474528ae772af84b2ab.webp)

把部门拖到筛选区域，点击漏斗形状的筛选按钮，就会弹出筛选窗口。可以根据需要选择一个或多个部门。


![img](https://pic4.zhimg.com/v2-102cc4929e3b74df7fbb6c32776865a4.webp)

我们还可以通过不同的组合创造更加复杂，从更多不同的维度来观察和分析数据。本例中只有 5 个关键字段，但通过不同区域的排列组合，可以提供十几甚至几十种不同的数据透视表，这里就不一一举例了，大家可以自已做一做。


上面这个例子比较简单，可能你不会感觉有什么效率上的大幅提升，那些不同维度的统计也能用函数给计算出来。但是如果遇到数量量非常大，字段很多，需要从不同角度进行分析的情况，数据透视表就显现出巨大的优势出来。


![img](https://pic4.zhimg.com/v2-751ed4676f9acc6998be5884e14d89df.webp)

如图，这是模拟的一个电商网站的销售数据，可以看到字段很多，数据量也很大，如果用传统的函数公式来计算和分析，需要很长的时间，也容易出错。而用透视表就非常方便，能从不同的维度来进行综合分析。


![img](https://pic4.zhimg.com/v2-d3b479c21d4bd6fe372d82a38d7241bd.webp)

例如通过对「付款时间」这个字段进行组合，我们可以方便快捷地统计出日销售、月销售、季度销售和年销售。


![img](https://pic3.zhimg.com/v2-e86bd96281164a445f3eab3d62409845.webp)

可以用筛选功能，统计出每个商家的月度、年度销售额。


![img](https://pic1.zhimg.com/v2-a9e5143b943d850f86b859c948535848.webp)

也可以把商家和销售额都放在行区域，查看不同时间维度上的环比、同比以及其他数据分析。


![img](https://pic3.zhimg.com/v2-b62c59a0003eb97ab4083ac654c93532.webp)

也可以横向对比，每个月不同商家的销售金额。


![img](https://pic4.zhimg.com/v2-dfe60c7d47f0888d39fe50b04fb0f00a.webp)

通过值字段设置，更改「值显示方式」可以直接统计出数据在行、列汇总中所在的百分比。


一表变 N 表，表表都不同。同样的数据不同的视角和维度可以有无数种组合，就看你怎么玩了。


除了上面介绍的的玩法，透视表还有一个更牛的功能，就是切片器，我们来了解一下。


![img](https://pic1.zhimg.com/v2-40a2840f703e2edd6b0a5426ca939796.webp)

我们回到之前的例子，插入透视表之后，勾选好各个不同的字段，然后鼠标在透视表对应的列上点右键，弹出菜单取消「分类汇总学历」前面的勾。


![img](https://pic4.zhimg.com/v2-b329d92ccba576f8d07c6b76d3af3f5b.webp)

鼠标定位到透视表，然后在「插入」选项卡选择「切片器」，然后勾选「部门」字段。


![img](https://pic4.zhimg.com/v2-ffc1053f872fa8b358dada6631f71981.webp)

这时候会发现左侧多了一个窗口，显示有各个部门的标签，上方还有两个按钮。先试着点击不同的部门，这时你会发现右边的透视表会随着你的点击进行变化。


![img](https://pic4.zhimg.com/v2-979f69f1cb5ffe533f3e6a36efd0ffbf.webp)

这时候你的透视表又摇身一变，成了一个小型的动态数据库了，数据会随着切片器进行动态的变化。上面左边横线前面带勾的按钮是多选按钮，点击它之后，再进行选择，可以选择一个以上的部门。右边漏斗加叉的按钮是清除按钮，清除所有的选择回到初始状态。


![img](https://pic4.zhimg.com/v2-e82d165ef2896c6494b0a85e35016428.webp)

你还可以插入多个切片器，进行交叉筛选。如图，可以筛选出事业部本科学历的员工，实在是太方便了！


![img](https://pic4.zhimg.com/v2-9795775f4fa7cbaa04180028065590cb.webp)

遇到数据量大字段多的，例如前面的电商销售透视表，插入几个切片器，动态地查看数据，想怎么看就怎么看。


例子很简单，但足以说明问题。更多复杂的用法无非这些基本概念的不同组合。限于篇幅，我们也不可能把所有的用法都罗列出来。数据透视表的强大就在于基本玩法简单，但却有无数种可能性。平时没事的时候花点时间多研究研究，关键时候一定能派上用场。


设想一下这个场景，在工作汇报会上，其他同事展示的都是事先计算好的静态数据，而你的汇报除了能展示静态数据外，还能从不同的角度不同的组合来动态展示数据，你估计在领导心里能你加多少分？


备案号:YX01KMZyZJr4AWvJj


###### 2020-12-23 06:26

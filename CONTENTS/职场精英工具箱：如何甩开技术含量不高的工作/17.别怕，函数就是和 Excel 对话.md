## 17.别怕，函数就是和 Excel 对话
可能是因为上学的时候被数学函数、物理定理、化学方程式虐得太狠，所以大多数人听到函数两个字，或者看到外观形状类似函数和公式的不明物体就会眉头突然紧锁，头上三条黑线，背后一身冷汗。尤其是非理科专业的，会立即认怂，饶道离开。


其实大可不必，Excel 里的函数没那么复杂，它其实不过是你和电脑对话的一个窗口，也可以把它看作是一种语言。把我们想要做的事情从自然语言翻译成 Excel 能懂的语言，它就会按照我们的指示给出结果。


我们从一个例子开始来了解怎么用函数和 Excel 对话。


1.文本提取函数


![img](https://pic4.zhimg.com/v2-e39c3c8bec7f44c97cabb75038e78a54.webp)

把图中所示部门和姓名分离出来，可以用数据分列，前面章节已经介绍过，现在我们看看用函数怎么实现。


![img](https://pic4.zhimg.com/v2-a83b2cc43871e849dcf812a53c6d19a1.webp)

鼠标点击「部门」下面的单元格，就是图中的 C2 单元格，然后如图所示：「公式」选项卡-「插入函数」，搜索函数窗口输入函数名称「left」，点击「转到」，选择函数后点击「确定」。


![img](https://pic1.zhimg.com/v2-222a864da20538f467e7a5c2f1c18d6e.webp)

「函数参数」窗口中的第 1 个参数「Text」输入栏,输入目标字符，本例中就是 A2 单元格。在第 2 个参数「Num\_chars」输入栏，输入字符个数「3」。这时可以观察到计算结果「工程部」已经在输入栏右下角显示出来了，点击「确定」完成输入。


![img](https://pic1.zhimg.com/v2-bc2d6a5e607f6dd3964345f0012b575d.webp)

完成输入后，单元格也显示出了计算结果。同时上方的编辑栏也显示出了完整的函数。这个函数「=LEFT(A2,3)」，翻译成「人话」，意思就是「把 A2 单元格的字符给我取出来，从最左边开始，取 3 个给我！」


![img](https://pic2.zhimg.com/v2-f3ba058b34e539e0780ccba01a54b8f6.webp)

搞懂了之后其实也没有太难，同样的我们还可以用 MID 函数把姓名也给分离出来：


![img](https://pic3.zhimg.com/v2-4616bde9b355d9926052bda9339c900f.webp)

方法和上面类似，只是多了一个参数，输入完成就会显示出姓名。这时候用鼠标选择分离出来的部门和姓名单元格，也就是 C2 和 D2。把鼠标放在 D2 的右下角，当它变成一个黑色十字架的时候往下拖动鼠标。其他单元格就会自动填充函数，并且计算出结果。


![img](https://pic1.zhimg.com/v2-49f832615bce77855bf5ae952198cd2b.webp)

这时候函数的魅力就显现了，无论几百几千行，立即完成。想像一下手工复制粘贴，得加多少班？


通过身份证号找到出生年月日，前面我们是用数据分列解决的。用 MID 函数也可以轻松完成，自己动手试一试。


下面我们再来看一个例子。


应用场景：


1.在一大堆数据当中找到的几个特定数据的位置。


2.反回这个数据所对应的其他数据。


![img](https://pic4.zhimg.com/v2-2dd3b81bd0b13312131da34620dccfcc.webp)

如图，我们要在上面表一里找出表二这几个明星的片酬。这个表很简单，你可以用肉眼找到，也可以用查找功能找到，但在几万行数据里找到多个特定数据，相信你会变成加班狗！


操作步骤如下：


第一步我们要找到表二中姓名所在的行号，然后再去找姓名所在这一行后面一列对应的「片酬」。


在表二的「成龙」后面一个单元格输入下面这行公式


=MATCH(F3,A:A,0) 


这个函数用「人话」来讲就是这个意思：在这一堆名字里面找到「成龙「，告诉我他在哪一行。


![img](https://pic3.zhimg.com/v2-70fb79f92538d94184dbbef735e986de.webp)

注意："F3"是「成龙」这个姓名所在的位置，就是你要找的目标，如果你不知道你的目标所在位置是多少，用鼠标在上面点一下，看下图


![img](https://pic4.zhimg.com/v2-b27dca3320022450d6f27928ab702089.webp)

在你自己用的时候，要记得把这个 F3 改成你目标所在的位置！


那么「A:A」是什么意思？就是姓名所在的这一整列。告诉 excel 在这里面去找。


最后一个 0 就是指精确查找，一般情况下写 0 就行了。


如果你没有打错字的话，现在结果应该出来了，「3」！


在表二「3」后面那个单元格（H3 单元格）输入


=INDEX(B:B,3,1)


这个函数用「人话」来讲就是这个意思：在教室里面，把坐在第几排第几列的那个人给我找出来！


![img](https://pic2.zhimg.com/v2-054160459c5452d813b3c366b41d7672.webp)

「B:B」指的就是片酬所在的这一列，是 B 列。


「3」是上学期我们找到了「成龙」这个名字在第三行


「1」指的是从 B 这一列开始的第 1 列。


如果你是小白，不明白相对位置，「1」就永远写 1，不要变。


"B:B"根据你要找的数据所在列来改变，数据在哪一列，字母就改成那一列。


这个时候结果应该出来了！


![img](https://pic3.zhimg.com/v2-b7a8e604634c8d008293afdbde39d7ab.webp)

把「=INDEX(B:B,3,1)中的「3」改一下，改成「G3」，然后回车。也就是「3」所在位置的行号列号。


现在公式是这样：「=INDEX(B:B,G3,1)」，意思是：在 B:B 里面找出行号为 G3 单元格的中的数值同时列号为 1 的单元格，返回这个单元格的内容。


用鼠标在 G3 单元格点一下，然后按住左键向右拖动，同时选中「3」和「4500-5000 万」这两个单元格，然后把鼠标放到单元格右下角，鼠标的形状会变成黑色小十字。


![img](https://pic1.zhimg.com/v2-5eda51900e60db46b4bb5494b60b008e.webp)

这时候按住左键向下拖，下面的所有公式会自动生成，有几千上万行也是瞬间搞定！


如果你去看下面几个单元格的公式，原来的「F3」、「G3」会自动变成「F4」、「G4」。


![img](https://pic2.zhimg.com/v2-b8e5c85ce9748bc9542b161c21f8f888.webp)

别小瞧这几个函数，你到公司财务部去问一下，那些天天盯着表的会计们也不是都会用 index 和 match 函数的。


通过上面的例子你应该明白如何用函数去和 Excel 对话，告诉它你想要它执行的命令。


函数有简单的有复杂的，有些复杂的函数可能有很多参数。初学者应该优先掌握参数简单容易理解的函数，运用熟练了再去学习更为复杂的。不然很容易一开始就被弄晕了，反而放弃所有函数的学习了。


还要提醒的一点是，刚开始少用函数嵌套，多用辅助列。例如上面这个例子实际运用的时候多数情况是这样：「=INDEX(B:B, MATCH(F3,A:A,0),1)」，G3 直接用 MATCH 的函数代替。这样一个单元格里的函数就能搞定，不过缺点是新手不容易理解。倒不如建立一个辅助列，拆成两个函数，也容易检查错误。


在学习新的函数时，多用函数指导和帮助文件，搞清楚函数的功能作用以及每个参数的意思。如果还是不明白，就上网搜索一下，看看别人举的实例。


Excel 一共有几百个函数，没必要也不可能全部掌握。但是只要你搞定了其中哪怕 10% 的函数，就能少加很多不必要班，少做很多无聊单调的重复劳动，你的工作效率会成级数倍的提高，在时间上的投入产出比是非常可观的。


备案号:YX01KMZyZJr4AWvJj


###### 2020-12-23 05:57

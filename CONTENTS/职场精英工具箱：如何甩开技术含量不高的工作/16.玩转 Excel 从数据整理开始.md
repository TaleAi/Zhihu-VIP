## 16.玩转 Excel 从数据整理开始
考古学发现，人类最早留存的文字记录是一个叫「库辛」的苏美尔人用楔形文字在泥版上刻下的这样一句话：


29086（单位）大麦，37 个月，库辛。


时间大约是公元前 3400 年-公元前 3000 年，距今已有五千多年了。


不是哲学家关于人生的思考，也不是传唱英雄人物的诗歌传奇，人类最早的文字记录就是干巴巴的一堆数据——债务、税务以及财产。


就像人类文明离不开数据一样，现代化办公的数据处理也离不开 Excel。从问世以来，它不断地渗透到各行各业的方方面面。工作汇报、绩效考核、数据分析、财务报表、人事统计，无所不在、无孔不入。虽然学校里不教，但实际 Excel 已经成为职场的标准技能。要用好 Excel 基础要打牢，首先要学会处理数据。就像厨师要先学会处理食材才能做出可口的饭菜一样。把杂乱无章不合规范的数据整理好，才能按需要提取到数据里面包含的信息。


下面我们就从最基础的数据处理方法开始为大家提供一种从零开始入手学习 Excel 的思路。


1.规范数据格式


打开 Excel，选中任意一个单元格，点鼠标右键，在弹出菜单中选择「设置单元格格式(F)」或者直接按快捷键「Ctrl+1」。


![img](https://pic2.zhimg.com/v2-b23860f340094e5aa0f82e805218b102.webp)

在单元格设置窗口的「数字」标签中，有 12 种分类。涵盖了日常所需各种数据格式，最后一种「自定义」更是包含了无限可能，让你可以创造自己的格式。


很多新手就是因为没有数据格式这个概念才会出现这样那样的各种问题，总觉得不按你的想法来，设置格式就是事行告诉 Excel 你的想法，它了解了你对这个数据的想法，就会按你的意思来呈现。


举个例子，很多人录入身份证的时候起的就输，输完一看成了 4.205E+17，后面的数字都不出现。因为 Excel 并不知道你是要输一串用来计算的数字还是身份证或者银行卡。超过 11 位自动显示科学计数，超过 15 位就无效。


正确的打开方式是调出单元格格式设置窗口，把单元格设成文本，然后再输入。不光是身份证、银行卡号，包括日期、时间的输入都要事先设置好单元格再输入，比输入完了再来设置格式要省事的多。


* 用分列处理数据

有时候我们的表格打开是一些不合规范的数据，这就需要对数据进行加工和处理。


![img](https://pic4.zhimg.com/v2-fb62564defda4e9684e7512a921e213c.webp)

在「数据」选项卡里面找到「分列」就可以打开分列向导窗口。这里说明一下，本书中的截图都是 Office2013 以后的版本截图，如果你还在用 Office2007 甚至 Office2003，赶快升级吧！那都是十多年前的古董软件了。


这里有两种选择，一种是「分隔字符」，一种是「固定宽度」。我们先来选择「分隔字符」，然后点击窗口下方的「下一步」。


![img](https://pic4.zhimg.com/v2-507ed129e2de2532980be73acb6554c5.webp)

先取消「Tab 键」前面的勾选框，然后在最下面的「其他」输入我们要做为做分隔标识的字符，本例中是「/」。这时候下面的「数据预览」就会实时显示分隔后的数据，继续点「下一步」。


![img](https://pic2.zhimg.com/v2-7f6701a5dc0466197f0cba78e733dd1e.webp)

在窗口中选择数据格式，本例中是日期，在目标区域点击右侧的向上箭头选择存放数据的单元格，本例中是第一行的 B、C、D 列。如果你不选择的话默认是原数据所在单元格，如果分列有误原数据也没有了。所以建议选择其他单元格，然后点击完成。


![img](https://pic4.zhimg.com/v2-e798d50bb812f7360f8dce92a61a7c19.webp)

如图所示，数据就自动存储在不同的单元格了, 当数据中间有特殊固定符号的时候这种方法非常管用。


![img](https://pic3.zhimg.com/v2-814006527551c5143c42fe5352588f61.webp)

我们再来看看固定宽度怎么进行数据分列：


![img](https://pic3.zhimg.com/v2-dc7f1a0ad82463d31f4a3846f2f9262b.webp)

本例中我们想通过选择「固定宽度」把身份证中的出生日期给提取出来，当然你也可以用函数来完成，这里我们用数据分列的方法。


选择「固定宽度」再点「下一步」。


![img](https://pic3.zhimg.com/v2-0e6e431237ba0e5234600beb4dfc1081.webp)

在第 2 步窗口中的「数据预览」中，拖动鼠标会出现一条竖线，把竖线放在合适的地方，就能完成数据分列，可以设置多条分隔竖线。本例中，是放在出生日期的两侧，点下一步后选择目标区域后点击完成。


![img](https://pic2.zhimg.com/v2-1fc72c5f951492eee2aaa1db2311bc7c.webp)

以上是数据分列的基本用法，没有什么特别的。在实际工作中合理运用这两种方法就能解决很多数据处理方面的问题。下面我们再通过一个实际的案例例子来讲讲综合运用。


![img](https://pic4.zhimg.com/v2-01e7032db6697703bf23f27df7386228.webp)

这是我国的省级行政区划，现在我们要把名字单独给分离出来。首先当然是用「、」做为分隔符把每个行政单位单独分出来。


![img](https://pic3.zhimg.com/v2-b11af4cd81da94c5edf70fb2d8458e09.webp)

分隔完之后会发现不同的行政单位处在不同的列，不方便操作。这里我们要用到一个知识，就是行列的转换，具体操作如下：


![img](https://pic3.zhimg.com/v2-8777be33b5e4197b8fb7221f71bbe346.webp)

选中第一行复制，然后在第一列的单元格点鼠标右键，在弹出菜单中选择「转置」，就从横向排列变成纵向排列了，这样方便我们后面的操作。


继续观察发现行政单位有「省」、「市」还有「区」， 用这些汉字做分隔符就能得到我们想要的结果。


![img](https://pic1.zhimg.com/v2-10b9d093b00a1c0dce03ada20fa92c48.webp)

如图所示，分别用「省」、「市」做做做分隔字符分离出省和直辖市，最后一步用固定宽度分离出自治区，在「内蒙」后加个「古」字，就全部完成了。


我们再看看这个例子，姓名和身份证号在一起，没有分隔符，固定宽度也不合适，怎么办？


![img](https://pic3.zhimg.com/v2-419266653732855c737de3daee2649cc.webp)

当然有办法，比如说用字符串函数也可以实现，这里我们介绍一种更简单的方法。


![img](https://pic3.zhimg.com/v2-5ee83128e69b14664a3641ee5eb0be64.webp)

拖动 A 列的宽度，让宽度刚刚够显示一个汉字。


![img](https://pic2.zhimg.com/v2-655f0fe16c3a250d7f6eddce18cb46f3.webp)

选中数据列，选择「开始」-「填充」-「内容重排」。


![img](https://pic3.zhimg.com/v2-479cb3b2794f76733c8132ffeb869b49.webp)

数字和汉字就被分成不同的单元格了，这时再选择菜单选项卡上的排序，就能得到我们想要的结果了。


![img](https://pic2.zhimg.com/v2-a759a41b5eed93928fc26a1b3303a776.webp)

除了上面这些例子，实际工作中会遇到很多数据源非常杂乱的情况，比如人事行政、库存管理、财务单据，数据中的姓名、数字、金额、单位都混杂在一起。


如果宽度一样就用宽度分隔，如果有特殊标记的就用字符来分隔，这个字符可以是符号、汉字、空格、数字，如果一步不行就分成几个步骤来完成。


要处理这些数据可能会用到多种不同的方法，甚至还要借助不同的软件，但是思路一定要清晰。


就像上面介绍的，知道了数据的不同格式以及分离、规范的方法，在工作中多思考多实践，慢慢你就会发现 Excel 并不难。学会了这些方法和技巧，会在工作中给你节省大量的时间，避免做一些复制粘贴手动录入的简单重复劳动。


备案号:YX01KMZyZJr4AWvJj


###### 2020-12-23 09:42

## 46.可逆计算
可逆计算（Reverse Computing，RC）的历史始于 IBM 的物理学家鲁尔夫·兰道尔（Rolf Landauer）在 1961 年发表的一篇题为《计算过程中的不可逆性和热量产生》的论文。在这篇论文中，兰道尔认为传统计算操作的逻辑不可逆性直接影响了正在执行这些操作的器件的热力学行为。 


最基本的物理学定律是可逆的。物理的可逆性意味着我们永远无法真正消除计算机中的信息。每当我们用新值覆盖某些信息时，先前的信息可能出于实际目的而丢失，但实际上并没有真正被破坏。相反，它已被推入机器的热环境中，在该环境中，它变成熵（本质上是随机信息）并表现为热量。 


当今的计算机一直都在抹除信息，以致传统设计中的每个有源逻辑门在每个时钟周期都会破坏性地覆盖其先前的输出，从而浪费了相关能量。从本质上讲，一台传统的计算机是一台昂贵的电加热器，它会执行少量的计算，但计算只是一个副产品。 


根据兰道尔的证明，在室温下，抹去每一个比特必须耗散至少 0.017 eV 的能量。虽然看上去这非常少，但是计算机中发生的所有操作加在一起，就是一个很大的数字。如今的 CMOS 技术消耗的能量实际上比兰道尔计算的要大得多，它擦除每一个比特消耗的能量在 5000 eV 左右。标准 CMOS 设计可以在这方面作些改进，但每擦除一次，仍有不低于 500 eV 的能量损失。 


在兰道尔之后，很多研究人员对这个课题进行了大量研究，目的是研发出一种可逆计算机，但是因为难度太大都没有取得明显成果。直到 20 世纪 80 年代初，爱德华·弗雷德金（Edward Fredkin）和他的同事托马索·托佛利（Tommaso Toffoli）在麻省理工学院的信息力学研究小组中进行了首次有效的可逆计算物理机制的尝试。他们提出，原则上可逆操作可以通过理想化的电子电路来实现，该电路使用电感器在电容器之间来回运送电荷。由于没有电阻抑制能量流，因此这些电路理论上是无损耗的。这种理想化的系统虽然无法在实践中构建，但是这些研究推动了现在称为弗雷德金门和托佛利门的两个抽象计算元件的发展，它们成为可逆计算中许多后续理论工作的基础。这些门可以对 3 个输入位进行运算，将它们转换为 3 个输出位的唯一最终配置，从而可以执行任何计算。 


传统计算芯片是由门电路等基本电路构建的，如 AND、NAND、OR、NOR 和 XOR 门。这些门在逻辑上是不可逆的，这意味着如果忘记输入值（A，B），输出 P 的信息不足以逆向计算并恢复（A，B）。根据 Landauer 理论，当使用一个逻辑上不可逆的门电路时，就已经把能量耗散在环境中。他同时指出，可逆门是不耗散能量的必要条件，但不是充分条件。一个消耗能量为零的计算机，不能用传统的门电路来设计，而只能用逻辑上可逆的电路来设计。 


**1.托佛利（Toffoli）可逆逻辑门**


在这种门电路中，输入和输出由输入  [P，Q，R]  和输出  [L，M，N]  给出，其中 L=P，M=Q，N =PQ⊕R，如图 8.10 所示。 


![img](https://pic1.zhimg.com/v2-6ca88974cf2386a20a3b8e8c321fc567.webp)

**2.弗雷德金（Fredkin）可逆逻辑门**


在此门电路中，输入和输出分别由输入  [P，Q，R]  和输出  [L，M，N]  给出。输出响应为 L=P，M =P'Q⊕PR，N=P'R⊕PQ，如图 8.11 所示。 


![img](https://pic2.zhimg.com/v2-bdb2fca9d9640d8082fd3a2f9db592cf.webp)

计算中所需的操作可用可逆的方式执行，因此不会散发热量。任何电路可逆的条件之一是，其输入和输出可以唯一地相互检索或一对一映射。另一个条件是，如果器件实际上可以逆向运行，则称为物理可逆。可逆逻辑电路具有以下规则：输出数量等于输入数量（n×n）；独特的输入到输出模式；不允许使用反馈电路或回路。 


近年来已经有人提出了可以执行正向和反向计算的可逆逻辑  [156]  （如正向模式中的乘法和反向模式中的因式分解），并可使用纳米磁性模型和玻尔兹曼机配置实现此独特功能，或在硬件中通过二进制计算或随机计算来达到近似。 


图 8.12 为使用玻尔兹曼机和随机计算（p 位长）  [156]  实现的可逆逻辑示意图。可逆逻辑电路在正向或反向模式下运行，使用具有输入  [ x    i   ∈{0,1}（1≤i≤p）]  和输出  [ y    i   ∈{0,1}（1≤i≤q）]  的哈密顿函数。例如，一个可逆乘法器展示了与固定输入相乘的能力（正向模式）和与固定输出进行因数分解的能力（反向模式）。如果固定了部分输入和输出，则可逆乘法器将作为除法运算。 


![img](https://pic4.zhimg.com/v2-0bd5450c6eaa0b09d177bd5900d20497.webp)

野泽直也（Naoya Onizawa）等人展示了一种使用 CMOS 可逆逻辑和随机计算的低功耗 AI 训练芯片  [157]  。一般来说，可逆逻辑的应用仅限于简单的功能，如可逆乘法器及因式分解器，但他们将其扩展到了深度学习。这种可逆计算结构的一个明显好处是，其具备的可逆性允许以推理所用的低位宽精度从输入/输出训练数据中直接计算权重值，而在一般 AI 训练中都需要使用高位宽精度。因此，基于这种可逆计算方法，可以使用相同的推理和训练硬件，实现更低复杂度、更低功耗的深度学习 AI 芯片。这款带有 CMOS 可逆逻辑的 AI 训练芯片使用 TSMC 65nm 工艺，可以执行正向和反向计算，功耗为 32.8mW，电源电压为 1.0 V，时钟频率为 100 MHz。 


很多研究人员继续探索可能的可逆计算电子实现方式。他们称理想化的热力学状态下的电路为「绝热的」。在该状态下，能量被禁止以热量形式离开系统。原则上，使用足够良好的绝热机制，几乎不会产生熵，并且几乎不需要消耗任何自由能（当然，实际上还有其他产生熵的来源，如泄漏、摩擦效应等）。这些想法后来在麻省理工学院得到了实现。在 1993 年，汤姆·奈特（Tom Knight）小组中一位名叫赛义德·尤尼斯（Saed Younis）的研究生首次证明了绝热电路可用于实现完全可逆的逻辑。这为设计和构建 CMOS 中各种类型的完全可逆处理器铺平了道路。也有研究人员一直在开发可逆的超导电子器件，如参量量子器（Parametric Quantron）和量子通量参变器（Quantum Flux Parametron）等。 


近年来，为了实现高能效的深度学习 AI 芯片，研究人员使用了可逆的超导电子器件——绝热量子通量参变器（Adiabatic Quantum-Flux-Parametron，AQFP）  [158]  。这款芯片同时也应用了随机计算技术。实验结果表明，他们提出的基于 AQFP 的 DNN 与基于 CMOS 的电路相比，可以实现高达 6.9×10  4  倍的能效，同时在 MNIST 数据集上保持 96% 的准确性。 


随着芯片的速度成倍提升，更快、更密集的封装和更高的晶体管密度会引起热力学问题。可逆计算的思想来自热力学和信息论核心理论，实际上，这是物理学定律中唯一可能把计算性能和能效一直不断提高的途径。现在的计算机（包括超级计算机）都是非可逆计算，因此每次要把 FLOPS 提高时，功耗就必然提高。可以想象，再过十多年到几十年，具有超级计算能力的计算机（或数据中心）所需的能量，将会超过一个核电站的发电量。只有可逆计算（包括使用可逆计算的架构、算法和器件）可以避免这样的现象出现。 


随着深度学习研究工作的不断深入，人们观察到某些 DNN 是可逆的，如生成模型只是前馈网络的逆向模型。为了了解这种近似的可逆性现象及如何更有效地利用它，有研究人员专注于理论解释并建立了稀疏信号恢复的数学模型，该模型与具有随机权重的 CNN 一致。 


研究人员试图把基于模型的压缩感知及其恢复算法和随机权重的 CNN 的特定模型联系在一起  [159]  。假设可以找到一个稀疏信号表达域，则有可能对信号进行欠采样，即不工作在奈奎斯特频率。通过近似信号形状，可以保留相关信息并发送它，而不用发送整个 ADC 读数，甚至可以直接处理在模拟域中压缩的信号，就像在模拟-信息转换器（Analog-to-Information Converter，AIC）  [160]  中那样。 


压缩感知曾经被成功地用于成像处理，把单个像素恢复成一幅可以识别的图像，现在也被用于无线通信、生物医学、模式识别、音视频处理等领域。而把压缩感知用于深度学习，利用了 CNN 的可逆性，可能会在降低功耗、减小中间层的存储量等方面提供很多好处。但是，这方面的工作还只是刚刚开始。 


可逆计算的一个例子是量子计算的应用。量子计算机是可逆的，因此理论上没有净能源消耗（实际运行时，由于大多数量子计算机在超低温下工作，冷却开销增加了能源的有效成本）。量子可逆性意味着量子计算机以无穷小（可逆）的步骤推动自己向前操作，就像香水分子从香水瓶中扩散出来一样。量子计算机程序不是「运行」的，而是随着输入到输出处理程序，因而被称为是「进化的」。顺便提一句，可逆性还意味着输出中隐含量子计算机的输入，该程序可以逆向运行以获取输入。 


可逆计算绝非易事，尤其在工程上实现的挑战是巨大的。使用上述任何一种技术来实现高效的可逆计算，都可能需要对我们整块芯片设计基础架构进行彻底的改变  [161]  ，并需要与基于新材料的新器件联合起来，才能有望实现持久性的新颖应用。也就是说，没有 10～20 年或更长时间的努力，可逆计算还不可能走向商业应用。但是，可逆计算是一条将对未来的芯片、AI 和计算机科学起到极其重要作用的康庄大道，只有它可以谈得上是计算领域真正意义上的一种颠覆性创新，因为所有其他的新兴计算范式（近似计算、随机计算、模拟计算、神经形态计算、储备池计算等）都不是可逆计算，而且在未来的某个时刻都会达到极限。 


备案号:YX01jbkWgwB9w7Lle


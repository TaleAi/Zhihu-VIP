## 77.基于储备池计算的 AI 芯片
当前的 AI 算法主要是基于模仿「大脑」的神经网络。多层结构组成的深度学习可以实现非常复杂的高级处理，但是需要花费很长的计算时间。另外，有研究人员发明了一种使用神经网络模仿「小脑」的新方法，与深度学习相反，这种方法是浅度学习，因而计算速度非常快。这种新的 AI 系统所基于的计算范式，称为储备池计算（Reservoir Computing）。 


储备池计算已有十多年历史，并且从机器学习领域开始逐渐流行起来。尽管它最初被定义为训练循环神经网络（RNN）的一种轻量级方法，但现在已经发展成为一种使用动态系统对时间序列数据进行计算的方法。 


从理论上讲，RNN 是完成复杂时间序列数据的机器学习任务的非常强大的工具。尽管如此，仍有几个因素阻碍了 RNN 在实际应用中的大规模部署。一个因素是它的学习规则还不多，并且大多数规则收敛速度慢，从而限制了它的适用性。因此，在 2001～2004 年间，先后有人提出了液体状态机（Liquid State Machine，LSM）  [228]  、回波状态网络（Echo State Network，ESN）  [229]  和反向传播解相关（Backpropagation Decorrelation，BPDC）学习规则  [230]  等一些新的想法，都是用 RNN 替代神经网络的中间层（隐藏层）来作为储备池，主要目的是省去训练，而用一个简单的外部分类层来「读出」数据。 


在神经网络中的每个节点（对应于神经元）处，输入到该节点的信号经过加权，通过适当的非线性函数输出，传播到下一个节点。改变权重相当于学习。在传统的神经网络中，权重基本上在所有节点上都改变。在储备池计算中，通过将输入映射到高维空间中（增强了可分离性），这种映射能够合并输入中存在的时间信息，无须调整内部连接权重，即可以利用递归非线性网络的动力学来处理时间序列，而无须训练网络本身，只需添加一个通用的线性读出层并仅对其进行训练即可。这样就可以简化系统（因为只需要优化读数权重），从而轻松地训练系统，但其功能足以与完成一系列基准任务的其他算法相媲美。储备池计算尽管不像通过 DNN 实现高级判断那样强大，但是可以通过增加储备池中的节点数等来改善要生成的输出信号的多样性。因此，它也可以进行复杂的处理。 


ESN 是最流行的储备池计算范例之一。它是一个具有随机输入和内部连接的稀疏连接固定 RNN。隐藏层的神经元（通常称为储备池）由于具有非线性激活函数（双曲正切是最常见的选择）而对输入信号表现出非线性响应。为了简便起见，下面所讲的储备池计算都指 ESN 算法。 


储备池计算具有许多优点。首先，计算对系统的初始状态不敏感，并且不需要控制信号，从而简化了设计和实现。同样，训练是在封闭形式的回归中完成的，不需要迭代过程。而且，非线性计算本身就可以通过网络动力学充当递归内核并提取输入信号的非线性特征。输入中的噪声、网络状态及节点之间的交互可以使用正则化进行处理，并且可以缩放以实现最佳性能。这是特别有吸引力的，因为这取决于要计算的动力学，而结构更改可能会对系统的动态状态产生不利影响，更改后通常需要对网络进行重新训练。另外，编程是在输出上执行的，而不是在网络上执行对特定任务的控制，因此可以使用同一器件同时计算多个功能。 


图 13.5 为储备池计算的示意图。储备池计算由输入驱动的 RNN（即储备池）和读出层（读取储备池状态并产生输出）组成。传统 RNN 在训练过程中将所有节点互连并确定其权重。而与传统 RNN 不同，储备池计算中的节点之间使用随机权重，节点之间利用随机稀疏连通性进行互连。输入和储备池的连接初始化后就固定了，通常无须进一步修改。 


![img](https://pic4.zhimg.com/v2-28930a2530eca559a3eed6bb0286354a.webp)

读出层通常是储备池状态的线性组合。使用监督学习技术确定读出权重，其中网络由教师样例输入驱动，并将其输出与相应的教师数据输出进行比较以估计误差。然后，可以在线下训练中使用任何封闭形式的回归技术来计算权重，如果需要在线训练，则可以使用自适应技术来计算权重。 


在数学上，输入驱动的储备池定义为：令 N 为储备池的大小，将时间相关的输入表示为列矢量 u（t），将储备池状态表示为列矢量 x（t），将输出表示为列矢量 y（t）。输入连通性由矩阵 W  in  表示，储备池连通性由 N×N 权重矩阵 W  res  表示。为了简单起见，假设有一个输入信号和一个输出信号，但是该表示法可以扩展为多个输入和输出。储备池的时间演变由式（13.1）给出  [231]  ： 


![img](https://pic3.zhimg.com/v2-4f64b2338195d5fc9348e41c3996417c.webp)

式中，f 是储备池节点的传递函数，通常是双曲正切，但也可以使用 S 形或线性函数。通过将长度为 N+1 的输出权重矩阵 W  out  与以 x′（t）表示的常数 1 扩展的储备池状态矢量 x（t）相乘来生成输出： 


![img](https://pic1.zhimg.com/v2-087ba57502c89b50ff60cbbc77ccf1f6.webp)

在这里，必须使用一对教师数据「输入-输出」，并使用回归来训练输出权重矩阵 W  out  。这种回归可以封闭形式进行，因此与传统的 RNN 训练相比，储备池计算的训练非常有效，而传统 RNN 需要耗时的迭代过程。 


图 13.5 中，细实线箭头表示固定的突触连接；虚线箭头表示可调连接。这种方法旨在把误差 d（t）-y（t）最小化，其中 y（t）是网络输出，d（t）是从目标系统观察到的教师数据时间序列。固定部分表示节点权重是固定的，节点间随机连接；可调部分表示可以更改输出层的权重，这也就是学习的过程。隐藏层中神经元的配置可以是任意的，但是为了简化硬件实现，常常使用环形拓扑。 


为了使网络正常工作，储备池必须处于适当的动力学状态，通常处于稳定与不稳定的边缘，以确保对过去的输入有足够的记忆，并对新的输入作出良好的响应。简而言之，系统必须具有足够的动态性，但又不能不稳定。 


储备池计算大大简化了 RNN 的训练过程，在强化学习、语音识别、噪声建模、混沌时间序列的生成和预测、机器人、信道均衡、自动控制等领域得到了成功应用。不过，这些应用中所使用的硬件，要么是使用 FPGA 或是在 CPU 上用软件模拟，要么是很多光学器件所组成的光学储备池计算，很少使用集成光子学技术。直到近两年才出现了较多基于硅光芯片的储备池计算研究成果的报道。 


图 13.6 为由硅光芯片组成的储备池计算原型的基本构成及要点。 


![img](https://pic3.zhimg.com/v2-ba18626740e65162d70594dd86ceb8d2.webp)

通过利用光路执行该储备池计算，可以实现比电子电路速度更高和功率更低的算术处理。在储备池计算中，输入层（光滤波器）和储备池的处理是固定的，并且可以使用光路相对容易地实现。通过在波长、相位和偏振方向上排列信息，可以在同一光路中进行大规模并行计算。另外，由于光路中不存在电阻，所以理论上布线功率为零，并且所有的计算都是通过光干扰进行的，因此可以以超低功率进行计算处理。通过应用光学器件技术进行通信，可以将它们以非常小的尺寸进行大规模的部署安装。 


这里储备池体现为一个环状的光路，其内部放置了一个半导体光放大器，以简单的构造实现了在循环的光信号之间产生非线性相互作用，并且产生储备池所需的各种复杂信号的功能。 


基于光学的储备池硬件实现可以充分利用光的优势（低功率、大带宽、固有的并行性等）进行计算。当信息已经在光域中时（如许多电信网络和图像处理应用的情况），这特别有吸引力。图 13.6 展示的使用带有耦合半导体光放大器网络的集成硅光芯片，其优势是所占面积非常小。此外，集成解决方案的机械稳定性支持直接使用相干光，其性能得到了显著改善。与实数网络相比，拥有一个以复数形式工作的储备池实际上会使系统的内部自由度增加一倍，从而导致有效的储备池大小大约是使用非相干光操作的同一器件的两倍。 


但是，包含光放大器的光子芯片并不是一种非常省电的解决方案，其速度从根本上受到载流子寿命的限制。近年来，研究人员提出了使用无源硅光芯片来实现储备池计算  [232, 233]  的方案。储备池计算的最新发展已经表明，对于某些非线性不是很强的任务，可以使用完全无源的线性网络——即没有放大器或非线性元素的网络来实现最高性能。所需的非线性通常是在光电检测器的读取点引入的。比利时微电子研究中心（Interuniversity Microelectronics Center，IMEC）的研究人员也展示了使用神经形态计算在硅光芯片中进行光学信息处理的最新进展  [233]  ，他们的无源储备池计算芯片已经用于以高速度和低功耗执行各种任务。 


克里斯托夫·范多恩（Kristof Vandoorne）等人提出了另一种体系结构  [232]  ，可以完全规避耗电问题。他们设计的储备池使用了无源硅光芯片，该芯片仅包含波导、分离器和组合器，即去掉了之前使用的放大器。结果，所需的非线性不再存在于储备池本身，每个节点输出波导中的信号是该节点输入波导的复数振幅的线性叠加。取而代之的是在输出读数处实现非线性，这里将储备池节点的复数振幅转换为实数功率水平，然后将其用作线性分类器的输入。以这种方式，储备池处理本身不消耗节点中的功率，即所有必要的功率都由输入信号提供。由于网络是无源的，因此唯一重要的时标是信号本身的速度和互连时延，而最终储备池时标仅仅由节点之间的互连时延来确定。 


迄今为止，光子储备池计算的实验演示在各种信息处理任务中的性能通常都是最先进的。基于具有时延反馈架构的单个非线性节点的实现已证明，光子储备池计算在模拟信息处理方面具有竞争力。此外，集成的光子储备池可以进一步提高数字信息处理的计算速度，并降低 AI 处理的功耗。集成的硅光储备池芯片特别受人关注，尤其是在 CMOS 兼容的平台中实现时，因为它们可以利用各自相关的优势进行技术重用并批量生产。 


备案号:YX01jbkWgwB9w7Lle


## 23.搜索是怎么回事
伴随着内容组织形式的不断丰富，应用内上线了专辑、作者专区、编辑专题等不同维度的内容二次组织形式。通过查看用户反馈，不少用户反馈表示搜索不出专辑，于是，将专辑等内容集合产品上线的任务就落在了阿聪的头上。 


说起来容易，做起来难。在完成初步内容接入搜索后，阿聪发现经常会出现搜不到、排列顺序不合理的问题，频繁地向研发反馈，让他疲于奔命，于是决定弄明白搜索是怎么回事，怎样才能做出更系统的方案。 


伴随着搜索技术的不断成熟，搜索已经逐渐成为各种产品业务的标配功能。无论是内容型产品、电商型产品还是社区、社交型产品，搜索都是产品业务中很重要的功能服务和流量入口。 


面对作为标配功能的搜索，我们应该如何应用和调优呢？接下来，就让我们追本溯源，搞清楚搜索到底是怎么一回事。 


搜索的场景还原
-------


搜索场景承载了用户的主动诉求表达。 


伴随着对产品服务的逐步熟悉，用户就一定会从被动接受的状态逐步生出自主探究、主动找寻的意图。在这种意图下，搜索就体现出了自己的功能价值。不同的应用对于搜索场景的依赖有强弱之分：同样是购物类应用，淘宝上的用户会更依赖于搜索的路径，而拼多多、小红书则更强调逛的体验。 


**搜索的基础结构**


为了简化理解，我们可以将搜索的前端结构拆分为两部分：搜索词的语义理解，搜索结果的召回和排序。 


第一部分代表了如何正确理解用户的意图。用户通常会用短语或自然语言的短句来表达自己的意图，那么首先就需要结合场景来更好地解析用户当下的搜索意图。常见的手段如分词（将一个短句切分为粒度更小的单词）、同义词变换（完成同义词之间的扩展，从而能够命中更多的内容）、纠错（将用户误输入的词语纠正为正确的词语）等。 


第二部分则代表了在理解用户意图之后，如何更准确地匹配用户意图。搜索系统通常包括召回和排序两个步骤。我们可以将召回理解为粗排序（海选），通过不同的召回策略和召回源，从海量的内容中检索出一个较小的集合；而将排序理解为精排序（排名），在已经检索出的较小的集合里面，进行进一步细致化的排序。 


在实操中，业务数据接入搜索的通常路径是： 


* 资源层：定向准备覆盖，保证对应的资源（如商品名、品牌名、商品描述语等）能够被检索得出。
* 技术层：优化搜索的算法效果（准确率和召回率）和服务质量（稳定性和响应速度）。
* 交互层：优化产品呈现样式（体验调优）。

通过逐步迭代的方式，一步步地收获搜索带给业务的收益。 


**衡量指标**


「又快又好」可以套用在很多服务的评价标准上，搜索自然不例外。 


第一个指标：「快」。明确的是搜索服务的可用度标准，即能够保证在特定时间内完成对用户搜索请求的有效响应。从某种角度来看，搜索的「快」既是工程指标又是业务指标，如果服务响应慢了，用户很可能就弃用了。 


伴随着网速的提升、移动网络的普及，用户越来越没耐心，对于搜索服务响应时间的要求也越来越高。在具体的业务场景里，我们可能会为了响应快的指标而放弃部分相关性的指标，以实现效果的折中。 


第二个指标：「好」。此指标更多的是围绕服务满意度的体现，同时涉及算法和产品两方面。在算法角度，衡量搜索服务首先考虑的是准确率（Precision）和召回率（Recall）两个指标，二者定义如下。 


准确率是指检索得到的文档中相关文档所占的比例。 


  



![img](https://pic3.zhimg.com/v2-d4e695ad09d52a943e67ed03a8d2192c.webp)

  



  



![img](https://pic3.zhimg.com/v2-07d5a56ed74ba0e5eeeddbfbaa461752.webp)

即表示检索出 10 个文档中，相关文档所占的比例。 


即  


![img](https://pic3.zhimg.com/v2-1d9b6e307f55f81d6077d7e23d22c5e5.webp)

通常，我们会考量搜索结果首屏的 N 条中准确结果的比例。 


召回率是指所有相关文档被检索出的比例。 


  



![img](https://pic1.zhimg.com/v2-2e11992d6913b4824c53f7565513aa78.webp)

  



套用通俗的表述来讲：准确率是指搜索出来的结果里有多少是靠谱的，召回率是指在所有靠谱的候选集中有多少被搜索出作为结果了。 


从准确率和召回率两个指标中不难看出，这两个指标和位置无关，更强调搜索出来的整体结果集的情况。但在业务场景中，我们通常需要进一步考虑位置相关的因素：搜索的结果列表页一定会有上下位置，更高的位置更容易得到用户的点击。所以，通过对于同样搜索结果集的顺序调整，将更相关的内容呈现在更高的位置，能够带来额外的收益。为此，我们引入了 NDCG 指标（Normalized Discounted Cumulative Gain）。在这个指标的计算中，高相关度的结果对于指标的影响更大，高相关度结果出现在更靠前的位置时，也会得到更高的指标。 


除了在工程、算法角度不断优化准确率、召回率等各种指标以外，站在产品角度，我们亦可以通过产品展现样式、交互方式等进一步提升用户的体验。对于高频的搜索词，常见的产品优化方式有内容覆盖、结果前置和结构化信息展示等。 


内容覆盖：从资源层的角度来优化搜索体验，对于没有满意搜索结果的搜索词，定向去补充内容和数据，更有针对性地去满足用户表达出的主动诉求。比如，当《流浪地球》上映的时候，用户往往会出现如「刘慈欣」「科幻」等时效性搜索词，作为业务方，可以通过及时引入相关电子书资源或者影评、书评等内容来满足用户需求。 


结果前置：当用户的主需求比较明确的时候，将用户想要获取的信息直接呈现在列表页上，变中转页为结果页，让用户不用二次点击即可享受服务。几个典型的示例，如百度、微信搜索「天气」，即可获得天气信息在搜索结果页的富样式展示，搜索「快递」，皆可在搜索结果中直接输入快递单号进行查询。 


结构化信息展示：在用户的主需求结果是可以被分类整理的情况下，通过运营的人工干预或规则干预，将主需求结果分门别类地展示出来，让用户可以更快速地筛选查看信息。比如，在视频应用中搜索某个明星人名，通常会系统地展现出这个明星参演的电影和电视剧、参加的综艺节目等。 


当然，无论是结果前置还是信息的结构化展示，都涉及成本的额外投入，需要我们对特定类型搜索词的频次和时效性有更好的把握。这也是会强调「高频」的原因，只有足够高频的搜索才能带来足够的收益，从而保证投入产出比的合理性。 


常见的产品设计
-------


**搜索页** 


搜索页的常见设计方式就是将热门信息（功能入口）、历史搜索前置暴露出来。 


热门信息的前置暴露，一方面起到的是纯广告的作用，另一方面是对于用户搜索意图的猜测。这是因为在特定的应用场景下，用户的主流意图是可期的。以视频网站为例，用户的搜索会集中在几档头部内容上，通过将热门信息前置，能够一定程度上降低用户的输入成本。 


历史搜索的前置暴露，取决于不同的业务场景。对于某些业务场景（如新闻应用），用户的搜索往往是一次性的，会在某个新闻事件发生后基于好奇的心态而搜索，但是在热度过去后并不会发生重复搜索的行为。而在另一些应用场景（如出行应用、视频应用），用户则会表现出一些基于时间的规律行为（工作日早晚出行、追剧），历史搜索记录的前置有助于降低用户的寻路成本。 


当然，将哪一种内容暴露出来，还是依赖于应用的特点和用户习惯，通过对于点击行为的量化来最大化利用搜索页面的效率。 


**搜索建议**


如果说搜索页面的露出热门搜索词的设计多少还存在一些利用页面进行广告曝光的意味，那么搜索建议则是完全出于降低用户输入成本，以完善用户输入意图的效率导向考虑。我们可以将其类比输入法的输入意图猜测。 


通常，在搜索建议的层面会涉及的功能点有：搜索建议词的匹配，拼音模糊匹配，同义词的建议，纠错的建议。在产品的交互样式上，也会直接在下拉结果的第一位通过异型的卡片化样式来提供更直接可访问的结果。 


**搜索结果页**


搜索结果页的设计通常会考虑有结果和无结果两类场景。 


有结果的情况，最直接的方式就是以列表页的形式将检索结果进行展示，同时对命中搜索词的部分内容进行高亮显示。对于可结构化的信息，还会通过卡片的方式将检索结果和服务更好地呈现。 


在复杂业务场景下（如电商），会对搜索结果进一步增加时间筛选、分类、标签等给用户提供二次过滤的选项。与此同时，还可以通过扩展搜索的方式，引导用户细化搜索意图，从而更快地收敛到用户更感兴趣的内容。 


无结果的情况，则主要需要缓解用户的不满意度，提升服务品质。常见的做法是推荐一些业务内的高热内容，给用户提供一些可能的候选解法等。 


阿聪有了自己的判断：「看起来，搜不到是应该推动搜索组解决的召回问题，产品更多地关注研发同学的改进计划和相关指标即可。在专辑的搜索展示效果上，我们也可以再出一组新的交互方案。」 


备案号:YX01W1dyn6MOMrNWw


###### 2020-07-03 11:36

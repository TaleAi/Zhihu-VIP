## 2.费马大定理：被智者孕育的金蛋
1995 年的一个夏天，有个男人伫立在百叶窗下许久，手里的刊例已经被他攥得微微变了形。


许久，他深吸了一口气并缓缓地说出：「让我们就在这里结束吧。」


这个男人叫怀尔斯，他手中的刊例正是《数学年刊》第 14 卷上最新的两篇文章——《模形椭圆曲线和费马大定理》与《某些赫克代数的环理论性质》。


当他说出这句话的时候，就意味着「费马大定理」这只被几世纪的智者接力孕育的金蛋终于被孵化了。


![img](https://pic1.zhimg.com/v2-ab7c0a9d2ab16c0e4654fd8679a0b12f.webp)

说到这场战役，不得不提它的发起人，出生在法国南部图卢兹附近的一位名为费马的人。


这场接力战役的枪声最早就是由这位「民科」躲在鼠疫肆虐的法国审判庭里打响的。


![img](https://pic3.zhimg.com/v2-a2473830f19a8456ef4457ed0903f276.webp)

费马的父亲在当地开了一家大皮革商店，并且拥有着相当丰厚的产业。所以费马从小生活环境都相当的富裕和舒适。


但是他并没有因为家境的富裕而产生多少优越感。


相反，他是一个矛盾的人。明明生性孤僻，却又希望流芳百世；明明自命不凡，却又习惯谨小慎微；他热衷挑衅，出了事却只会一味躲避。


![img](https://pic2.zhimg.com/v2-51c80b16b3bf9721d7945af75c611990.webp)

费马热爱数学，他对数学严谨又痴迷。他做起题来滴水不漏，论证逻辑也有条不紊。


但他却听了父亲的话考了公务员，并且当上了一名大法官。


这在当时也算是一件光耀门楣的大喜事。可这个法官却没有做到尽职尽责地为人民服务，反而因为他对数学的痴迷出现了多次的「冤假错案」。


![img](https://pic1.zhimg.com/v2-90590e90345d76110ec0b83bdc9086e4.webp)

这样的「不负责任」也体现在他作为「民科」的方面，他有一个极大的毛病：不提供任何相应证明，令人看了云里雾里，心痒难耐。


比如说，他写出一个推导结论后会在草稿上说出「我可以证明这个结论，但现在我必须去喂猫了。」「我可以证明这一点，但我要去洗头了。」「我能证明这个公式，但我必须要去遛弯了。」诸如此类令后代数学家抓狂的话。


同时代的不少人都恨极了费马的这种姿态，如近代哲学奠基人、数学家笛卡尔就对此愤怒不已，嘲讽费马是个「牛皮匠」。


而这个「牛皮匠」还真的不是浪得虚名。


1637 年的某天，他就以玩世不恭的姿态向世界吹了一个最大的牛。


那天午后，在自家小院里翻动着丢番图著作《算术》的费马，突发奇想地对书中的毕达哥拉斯定理 *x²+y²=z²* 进行了推广：


*x³+y³=z³* 


*x⁴+y⁴=z⁴*


......


他发现毕达哥拉斯公式存在着无穷的正整数解，但稍微把公式改一下，就找不出一个正整数解。


由此，费马大胆地提出了一个猜想： ***xⁿ+yⁿ=zⁿ*****，对于大于 2 的整数 n 没有正整数解。**


而这个猜想具体如何证明，费马没有给出。


他依旧延续「不负责任」的做派，在那本《算术》的空白处留下了一句世纪名言：「对此我已经找到了一个绝妙的证明方法，只不过此书空白处太小，我写不下，就不写了。」


没想到的是，费马懒得动笔的小事，日后竟困扰了人类 358 年。


![img](https://pic1.zhimg.com/v2-4e8af1097af7555bfb488e2f75d8f8c8.webp)

此后，这个猜想就像一只会下金蛋的鹅，一直从 17 世纪孵到了 20 世纪，直接贯穿了人类近现代数学史，并成功地为「民科」费马赢得了「业余数学家之王」的称号。


费马猜想犹如塞壬之歌一般，蛊惑着各路数学高手争相出手，谁知，就是这一小小猜想，证明了 100 年也没有答案。


![img](https://pic2.zhimg.com/v2-4594a1040c3fb5c97bf518c5eed9e216.webp)

对此，18 世纪的数学巨人欧拉产生了极大的兴趣。


于是，他把对费马猜想的证明提上了自己的人生日程。


![img](https://pica.zhimg.com/v2-5e0ba236a2dd98ba4d9cce0af55b8a50.webp)

天才一出手，就知有没有。


很快，欧拉发现了一条隐藏在费马注记里的线索，即无穷递降法。


**其以无穷递降法为出发点，成功证明了 n-3 时不存在正整数解，却无法证明此结论对任何指数 n 都适用。**


![img](https://pic3.zhimg.com/v2-a54a42e26d8f961e350163be45a0eca0.webp)

好在欧拉已取得首次突破，需要继续做的是证明下面的无限多个方程没有正整数解:


 *x⁴+y⁴+=z⁴*


*x⁶+y⁶=z⁶*


 *x⁷+y⁷=z⁷*


······


然而，数学家们取得的进展非常缓慢。


直到 19 世纪初，女数学家热尔曼冒险突破时代的性别束缚，才让费马猜想重新活跃了起来。


热尔曼证明了当 n 和 2n+1 都是素数时，费马猜想的反例 x，y，z 至少有一个是 n 的整倍数。


![img](https://pic2.zhimg.com/v2-8c747a2cc0dc71478739fc08a840b85d.webp)

在此基础上，1825 年，德国数学家狄利克雷证明了 n=5 时费马猜想成立。


紧接着，1839 年，法国数学家拉梅对热尔曼方法做了进一步改进，并证明了 n=7 的情形。


继欧拉之后，人类终于证明在 n=5 和 n=7 的情况下，费马猜想是成立的。


![img](https://pic3.zhimg.com/v2-db3a0ecc3583a3c219e6a6ea7b17ceb2.webp)

1847 年是令人兴奋的一年，拉梅和柯西两位数学家向科学院递交了盖章密封的信封。


他们默契地借助了「唯一因子分解」的性质，即对于给定一个数，只有一种可能的素数组合，它们乘起来等于该数。


例如，对于数 18 来说，唯一的素数组合是 18=2x3x3。


正当他们认为自己已经完整地证明了费马猜想的时候，很快被另一个数学家库默尔泼了一盆冷水。


库默尔发现了其中一个致命的缺陷，虽然唯一因子分解对实数是正确的，但引进虚数后它就不一定成立了。


拉梅和柯西最终惨败，这是一个黑暗的时刻，因为刚刚亮起的曙光又熄灭了。


![img](https://pic3.zhimg.com/v2-73a097f713ae430573dd002bc0e20b47.webp)

尽管后来库默尔由此提出「理想数」概念，开创了代数数论，并运用独创的「理想素数」理论证明了费马猜想对 100 以内除 37、59、67 以外的所有奇数都成立，但是对任一大于 2 的整数 n 依旧不成立。


整整 200 多年，每一次数学家试图重新发现费马猜想的通用证明都以失败告终。


即使到了 1985 年，人类发明的超级计算机能证明在 4100 万次方以下费马猜想都成立，但那又如何，再在后面加一个 1，那个数字对于费马猜想是否依旧成立，仍然不得而知。


这就是费马猜想的难处。


**大于 2 的正整数是无穷无尽的，将一个个数进行证明，是如何证明也证明不完的。**


![img](https://pic2.zhimg.com/v2-ad1f4fa4611187a958780d07bb73f63f.webp)

就这样一筹莫展了三个世纪，众多数学家的热情都快被磨没了。


算了，也许费马自己也没有办法证明，只是在那里瞎吹牛。


还是去研究点有实用性的东西吧！单纯的数学家们开始学乖了。


就当大家慢慢忘却费马猜想时，一件轶事却让费马猜想重获新生。


1908 年，富二代保罗·沃尔夫斯凯尔饱受情伤，决定午夜 12 点自杀，结果写完遗嘱后，他因无事可做算起了费马猜想。


他这一算错过了自杀的「良辰吉日」，索性就不自杀了。


为了报答这救命之恩，他把身家财产大部分留给了费马猜想，并宣称：谁要证明了这一难题，钱全部归他！


重赏之下，必有智者。


20 世纪，又是一股费马热浪来袭。


当时全世界的数学业余爱好者和一些妄人都试图解决这个问题，但很可惜，费马猜想只是变得越来越著名，而想证明它似乎仍遥遥无期。


直到 1997 年，英国数学家怀尔斯教授成功地获得了奖金，但这已经是几十年后的后话了。


正所谓「有心栽花花不开，无心插柳柳成荫」，无数专门研究数论的大家都没赢得这个智力游戏，反而是怀尔斯这个数论里的外行人最终赢得了胜利。


怀尔斯生平主要研究一种称为椭圆曲线的学问。


![img](https://pic2.zhimg.com/v2-9000b59ae7dce79839f50db877e4935c.webp)

有人可能不太理解，费马猜想和椭圆曲线有什么关系?以 x+y=z 为例，我们可以做这样的初等变换: 


![img](https://pic2.zhimg.com/v2-6b4f65c09f8a41368166011e3639fd03.webp)

将上式代入费马方程得:


*y²=x-432*


瞧，这一下就变成了椭圆曲线！


现在，我们知道原来的方程没有非平凡解（所谓平凡解，就是允许 X，Y，Z 其中一个数是 0)，所以这相当于说上面的椭圆曲线方程只有显然的有理数解(12,36)和(12,-36)。


但熟悉椭圆曲线和费马猜想的转换仅仅是一张「入场券」，这一点欧拉和高斯早已各自提供了证明方法。


关键还在于如何证明椭圆曲线和模形式之间是一一对应的关系，反过来间接地证明费马猜想。


**由此，证明谷山-志村猜想成了证明费马猜想的关键一环。**


![img](https://pica.zhimg.com/v2-00482f7e2b89e4f41b7dac6acce433ec.webp)

其实早在 1985 年，数学家弗雷就曾指出「谷山-志村猜想」和费马大定理之间的关系。


他提出：


假定费马猜想不成立，即存在一组非零整数 a、b、c 使得 *aⁿ+bⁿ=cⁿ(n>2*)，那么用这组数构造出的形如 *y²=x(x+aⁿ)(x-bⁿ*) 的椭圆曲线不可能是模曲线。


弗雷命题和谷山-志村猜想矛盾，但如果能同时证明这两个命题，根据反证法就可以知道费马猜想不成立，这一假定是错误的，从而证明费马猜想。


1986 年，肯·里贝特成功证明了弗雷命题，但他像大多数人那样悲观地认为自己无论如何也无法攻克谷山-志村猜想。


乐天派怀尔斯恐怕是地球上少数敢在白天做梦的人，他认为里贝特已经证明了弗雷命题，这说明已经到了攻克费马猜想的最后阶段了。


重要的是，这还恰好是他的研究领域。


他二话不说，把接力棒接到手中，自己关在小黑屋里 8 年，专心孵化这颗世上最难孵的金蛋。


俗话说，工欲善其事必先利其器，踩在巨人的肩膀上会看得更远且效率更高。


所以怀尔斯先机智地把欧拉、热尔曼、柯西、拉梅、库默尔等人的工作全研究了一遍。然后展开题海战术，把椭圆曲线和模形式所有的既有研究成果复习了一番。


![img](https://pic1.zhimg.com/v2-20bb0044d4de62d5bc7dfbb48f1fb61e.webp)

最终，他巧妙地利用了 19 世纪悲剧天才伽罗瓦的群论作为证明谷山-志村猜想的基础，突破性地将椭圆方程拆解成无限多个项，证明了每一个椭圆方程的第一项可以与一个模形式的第一项配对。


1991 年夏天，怀尔斯将当时最前沿的科利瓦金-弗莱切方法应用于各种椭圆方程的求解之中，证明了更新、更大族的椭圆曲线也一定可模形式化。


沿着这一思路，怀尔斯认为自己解决了费马猜想，并把这个消息公之于众。


听闻费马猜想被证明，全世界都为之沸腾。


没想到在最后的论文审核时，数学家凯兹指出证明中关于欧拉系的构造有严重缺陷，这是证明中的一个大漏洞。


以为自己可以就此休息的怀尔斯只好思考用其他方法来解决这个漏洞。


1994 年 9 月，怀尔斯想起了自己当初先用岩泽理论未能突破，而后才用科利瓦金-弗莱切方法试图解决这一问题。


既然单靠其中某一种方法不足以解决问题，那何不将两者结合起来试试？


问题解法就是这样，岩泽理论与科利瓦金-弗莱切方法结合在一起可以完美地互相补足，再也没有任何漏洞了。


当所有人都认为怀尔斯不可能证明费马猜想时，怀尔斯最终绝地逢生。


1995 年，他终于证明了谷山-志村猜想，并孵化了困惑世间智者 358 年的这颗金蛋。


![img](https://pic3.zhimg.com/v2-0edcc5c1c9b4e19033a38c0623490f3b.webp)

300 多年的跌跌撞撞，走走停停，怀尔斯最终结束了数学上这场最为艰难漫长的接力赛。


看着费马猜想被证明，终于可以被称为费马大定理，最不开心的恐怕是 19 世纪「数学界的无冕之王」希尔伯特(Hilbert)了。


![img](https://pic1.zhimg.com/v2-fc0b7ebc22335d69b74c68b71445975a.webp)

当他还在世时，有人问他为什么不证明费马猜想，他曾反问：「为什么要干掉那只下金蛋的老母鸡呢？」


在他看来，费马猜想为人类数学界立下了汗马功劳，很多数学家在证明费马猜想时反而创立了许多新的数学理论。这对数学界是十分有益的。


而现在怀尔斯这个「凶手」干掉了这只「母鸡」，不知道希尔伯特作何感想。


![img](https://pic3.zhimg.com/v2-fd165c3ec041050620ba49beacdf93d9.webp)

其实希尔伯特也不用伤心，因为这颗「金蛋」即使被孵化了，到今天仍能发生裂变。


代数几何中的椭圆曲线和模形式，以及伽罗瓦理论和赫克代数等椭圆曲线就是裂变之一。


2008 年，费马大定理在非对称加密领域再现神迹。


密码学朋克们将椭圆曲线加密法(EllipticCurveCryptography，简称 ECC)应用于比特币，使比特币成为数学上牢不可破的「数字黄金」，开创了密码安全史上的新篇章。 


在密码学中，加密是指将信息变为难以识别的形式的过程，解密则是将这种难以识别的信息重新恢复原状的过程。


加密的方法，通常是通过算法来生成一个完成加密、解密的「钥匙」。


在当前的加密算法中，主要有对称加密算法和非对称加密算法两种。


对称加密，是指信息的发送方和接收方使用同一个密钥去加密和解密数据。


其特点是算法公开、加密和解密速度快，适合于对大数据量进行加密，但由于需提前共享密钥，易泄露，安全性不高。


![img](https://pic2.zhimg.com/v2-149233dd4fda65cdc43d6c4654f01017.webp)

非对称加密，则能够很好地解决对称加密存在的问题：加密和解密的密钥不是同一个，用于加密的叫作公钥，用于解密的叫作私钥。


公钥可对外公开，但私钥相当银行账户的密码，需要持有者妥善保管。


![img](https://pic1.zhimg.com/v2-646dfd0ba8fa9030ebb182b91f74395d.webp)

ECC 与 RSA 一样，都是非对称加密算法中的典型代表，但两者所利用的算法实质并不相同。


RSA 算法自 1977 年被提出以来，就在电子商业中被广泛使用。


其算法本质，是建立在这样一个数学事实之上：将两个比较大的质数相乘很容易，但要对其乘积进行因式分解则十分困难。


![img](https://pic2.zhimg.com/v2-dd5804941ec0693711e24ee6ff1d3951.webp)

举一个简单的例子,我们通常很容易计算出 83 乘 89 的结果为 7387，但要对 7387 进行因式分解却并不容易，而 RSA 算法中的大整数一般要比 7387 大很多倍，目前除了暴力破解（这需要比较大的算力），暂时还没有发现其他更有效的方法。


但 RSA 有着单位长度较长、计算效率较低等缺点，如果作为因子的两个质数长度较短，被破解的可能性就很大。


为了加强安全性，当前的 RSA 算法一般采用 2048 位的加密长度，但这对服务端的效能消耗较高。


ECC 克服了 RSA 算法的一些缺陷，其运行机制非常巧妙，将加密问题转换成了椭圆曲线方程在有限域中的阿贝尔群，从而利用群论中阿贝尔群计算问题，采取公私钥和双密钥相结合的方式进行加密或解密。


![img](https://pic1.zhimg.com/v2-d0918fa7bead604582fc138c6af5fdfb.webp)

ECC 是利用椭圆曲线等式的特殊性质来产生密钥，其实质是椭圆曲线上的离散对数问题。


所谓离散对数问题，是指这样的问题：


给定质数 P 和正整数 g，知道 gx mod P 的值，求 X。


对于符合特定条件的 p 和 g，这个问题是很难算的。更准确地说，目前还没有多项式时间的解法。


而 gx mod P 的计算却非常快，由此造成了正向和逆向天差地别的计算速度。


打个比方，这就像将牙膏挤出来很容易，然而要挤回去，却很困难。


隨着新计算和计算力的增加，RSA 的密钥长度会成指数增加，而 ECC 密钥长度却只是成线性增加。


例如，128 位安全加密，需要一个 3,072 位 RSA 密钥，需要一个 256 位 ECC 密钥；增加到 256 位安全加密，需要一个 15,360 位 RSA 密钥，则只需要一个 512 位 ECC 密钥。


也就是说，256 位的 ECC 密钥加密強度等同于 3072 位 RSA 密钥的水平(目前普通使用的 RSA 密钥长度是 2048 位）。


因此，ECC 算法可以用较少的计算能力，提供比 RSA 加密算法更高的安全强度，能够更有效地应对「提高安全强度必须增加密钥长度」的问题。


当前，ECC 已经开始逐步取代 RSA 等其他密码体系，成为密码学的新生巨星，是日后非常重要的主要非对称加密技术。


**那么，数学家们花了几百年证明费马大定理有意义吗？**


多少世纪以来，不断有数学家向「不可能」的费马大定理发出战书，有的因为能力有限早早放弃，有的倾其一生也只看清楚一鳞半爪，最终连万能的计算机也无可奈何。


在这个过程中，很多人都知道，也许一年又一年地耗下去依然得不到一个结果，成千上万个方程可能也得不出一个解。


但他们最终还是向永恒发起了挑战，即使计算机已宣布放弃，这些人依然觉得自己可以解决这个难题，这就是人类的坚强和韧性。


回望这 300 多年，人类每一次都用尽全力地追寻，虽然未能抵达终点，却在这路上扩充了「整数」的概念，扩展了「无穷递降法」、虚数和群论的应用，催生出库默尔的「理想数论」，促成了莫德尔猜想，证明了谷山-志村猜想，加深了对椭圆方程的研究，找到了微分几何在数论上的生长点，发现了科利瓦金-弗莱切方法与伊娃沙娃理论的结合点，推动了数学的整体发展……


![img](https://pic2.zhimg.com/v2-ae6496a3e41b97bb83abeec97167b214.webp)

一部波澜壮阔的数学史由此徐徐展开，这是一场智者征服世间奥秘的接力赛，而信仰和追寻就是这场接力赛的最大意义。


毕竟，正是因为有了一群仰望星空的人，人类才有了希望。


备案号:YX01x6YVYl3xrBrOA


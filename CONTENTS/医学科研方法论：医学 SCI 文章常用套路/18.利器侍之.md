## 18.利器侍之
今天我们来到了《三十六策》第三章「始制有名」的最后一讲，也是整个《三十六策》上半部分收官的一策。


经过一段时间艰苦的学习，我相信大家多多少少能感觉到比之前的自己有明显的进步。


老谈分享过一句话我蛮喜欢的：未来的你一定会感谢现在努力奋斗的自己。来！干完这碗鸡汤，让我们开始学习第 18 策「利器侍之」。


这一策我们要讲一讲生物数据库和生物信息学软件在基础科研中应用，俗话说：工欲善其事，必先利其器。这些生信工具是科研的利器，有效利用能大幅提升你的研究效率。


当然工具也并不是越多越好，太多会「乱花渐欲迷人眼」，不知不觉中把你带偏。


我听说过一个故事，很有启发意义。有位兄弟比较喜欢大保健，第一次去的时候推门进来一个学生妹，感觉不错，后面就经常光顾。有时候来的是护士，有时候是秘书，有时候是空姐，直到有一天来一个女警察，他嗷的一声就扑了上去，结果悲催了，这是个真警察。


温水煮青蛙，很容易使人对危险丧失判断力。生信工具给人的错觉是好像拥有了工具就能够统治科研数据的世界，很遗憾！这绝对是假象。


在过去的几年里我看到一些纯生信套路的文章被人开发出来，从最开始发 10 来分到后续复制的迅速跌到三五分，然后再滑落到一两分，中间就是隔个两三年而已。


生信的套路更新迭代非常快，快到你刚学会，它就差不多要过时了。


开发套路的是大神，一般人还达不到。跟风的也需要追得紧，等后知后觉凑上来，那这些套路的性价比已经非常低了。


我们学员当中有一部分已经经历过生信灌水的阶段，他们共同的感触是套路虽好但有局限性，想科研长久走下去，回过头来还是得返璞归真，研究分子机制的这套体系。在初学者中，有相当一部分同学觉得自己发不了 SCI 是因为不会生信的套路，像歌里唱的：得不到的永远在骚动，被偏爱的都有恃无恐。既然大家很想学，我们肯定要教，但在 36 策中，我没法关注太多的细节，只能先把如何利用生信工具的思路传输给大家。


从全局观念上看，生信是一门独立的学科，能力有三种境界：专业级选手是研究各种算法和架构数据模型的，精通至少一种编程语言，比如现在比较流行的 Python 语言，他们的工作状态跟程序员很接近，光靠编程就可以有一碗饭吃，我们这些业余科研人员对这种水平恐怕是望尘莫及。


退而求其次，第二种境界，做一个生信的资深爱好者，其进入条件是必须掌握 R 语言。R 是专门用于统计分析和作图的语言，比编程语言要简单。把 R 玩好了，统计软件和作图工具你就不用学其他的了，而且因为用得人多又是开源软件，有很多现成的扩展插件，俗称为「包，package」，即一套数据处理的工作流程，人家把代码都写好了，你只要拿过来调一下参数就可以用，非常的高效。


当然 R 的难点也恰恰在于包太多了，对新手而言像天书一样，拿到手也不会用。不管怎么说，R 是数据挖掘的基础，这一层境界是医生在业余时间刻苦学习可以达到的。学习周期大概半年到一年，如果你统计学得比较好，上手就快。要想仅用生信手段就发 paper，R 语言是必学的。


如果你不想专门耗费大量时间学 R，那么所谓的生信分析仅仅是用用现有的在线数据库和软件工具而已，这是第三层境界，叫业余水平。业余选手是希望点点鼠标就把数据分析给做了，但好的工具都是收费的，收费的用不起，免费的功能又有限。这么一来，人家数据挖掘是挖个大洞，你就只是刨个小坑，输出的数据层次上会比较单薄，单薄到必须要与细胞、分子、动物的数据相配合，才能形成完整的 story。


其实，对绝大多数搞基础科研的人来说业余水平够用了，生信分析只是一种辅助手段，掌握一点生信技能可升级成为一个「干湿结合」的双修科研选手。


干湿结合是一个行话，科研界把用生信搞研究的策略称为「干实验」，而把细胞分子生物学研究称为「湿实验」，摆弄瓶瓶罐罐的细胞和分子实验确实很湿，跟网吧一样的生信实验室自然是干了，这是一种比较形象的比喻。


我们不难发现，近几年干湿结合已经成为基础科研的一种常规配置，生信数据分析加上生物学实验验证可以发高水平的 paper。


完美的双修肯定是练玉女心经那样的双修，你做生信我做细胞、分子实验，咱们一起 co 文章，琴瑟和鸣、比翼齐飞。但是现实中往往是周伯通那种左右互搏的双修，一个人要学习两种技能，宝宝心里苦。


医生本身要干临床，同时做科研，即临床科研双修。做科研还要临床研究加上基础研究双修，然后基础科研里还要干湿双修，技能点加得实在有点多，所以杂而不精便成了普遍现象。我个人并不赞同临床研究、生信还有基础的套路都去全方位学习，每一个都包含了海量的知识，需要大量精力投入。在能够合作的情况下，各取所长克服技能短板才是最有效率的解决问题思路。


今天我们重点讲一讲大多数医生做基础科研需要达到的干湿双修的生信业余水平应该掌握哪些技能。


生信技能配合基础研究主要有两种应用场景：


其一是解决筛、猜获取新变量，也就是 Candidates 的问题。当变量代入恒量找研究靶分子的时候，你可以通过在线的数据库对别人用过的高通量数据进行二次挖掘，实现数据的再利用。


其二是筛或者猜机制的时候，工具和数据库也可以帮助预测，指引你研究的这个分子跟哪些通路、哪些下游分子可能有关联。如果下游有很多分子都发生变化，还可以构建调控网络，把复杂的信息可视化变成一张信号通路图。


实际上在整个课题展开的过程中也只有两个环节需要筛猜——找主变量以及已知主变量找机制的因变量。两步关键的动作都可以加入生信工具辅助，所以就算不发展到学编程语言这一步，掌握一些必要的数据库和软件使用也是当前形势下做基础科研的基本功。


科研和临床完全不同，大家刚一接触表型的概念觉得不好理解，就是话语体系转换的困难。


在科研里，临床研究、基础研究和生信分析这三套又各自成体系。哪怕是生信领域最简单的数据库使用，很多学员也觉得一下子难以上手。用数据库的诀窍其实就两个字：瞎点！猫大老师分享过陌生数据库的学习方法，跟我的看法不谋而合——把每个能点的按钮都点一遍，把界面里不懂的单词搞懂，一个数据库差不多就会用了。关键还在于各种按钮你随便点，点错了并不会罚钱。


一般数据库还有专门的说明文档，有点耐心仔细读一读，问题就迎刃而解了。有相当一部分同学一说到各种数据库就焦虑的不得了，主要是看到英文界面心里就很抗拒。这归根到底还是懒，就像小孩子如果你一直喂他饭，他可能到五六岁都不会自己吃，纯粹是惯出来的毛病。


从你做科研的第一天起就要跟英语打交道，同时你也在跟各种各样之前你没有用过但必须要去学习的软件打交道。比如我们平常整理文献用 endnote，查文献的 pubmed，做序列比对分析的 blast，以及做 PCR 引物设计的各种软件等等。有些是在线的，有些可以本地安装，凡是本地运行的都可以理解为软件背后是一套算法，而在线的工具，部分是算法、部分是存数据的，大量的实验数据组成一个 database，就这两种形式。为了描述方便，我们姑且笼统地都叫「数据库」吧，因为到底是软件算法还是数据集合这个概念在科研界区分并不严格。


所有数据库可以按用途分为 4 类：信息数据库、通路数据库、互作数据库和样本数据库。


我们已经提到过不少数据库，如 NCBI 的 Genebank、Nucleotide，查基因信息的 Genecards，查 miRNA 序列的 miRBase，查 lncRNA 的 noncode，还有 UCSC、Ensenbl 查启动子区域信息，ORF Finder 分析一段序列是否编码蛋白，CpG Finder 找 CpG 岛位置等等。凡是跟基因、非编码 RNA 分子序列或者功能注释相关的数据库，统称为信息数据库，就跟公安局存个人身份证信息、户籍信息一样，这是分子的特征信息。当我们启动一个课题，面对大量分子需要选择的时候，或者已经有一个确定分子需要检测它表达水平的时候，信息数据库是我们最早用到的一批工具，同时这一类也是使用上最简单的数据库。


第二类是通路数据库，其中有大量工具可以用，最经典的有三个：KEGG，DAVID 和 GSEA，这类数据库主要功能是聚类，把相关的分子归为一类。


人脸识别功能大家知道吧？识别人脸是依靠模型里七八十个特征点的坐标来实现的，一旦所有参数都配上，就是符合的对象。这些通路数据库的聚类功能也是一样，他们把分子按照功能表型进行了特征归类，当你手上有一份高通量数据输入进去，就可以告诉你研究中变化的分子跟哪些已知的特征比较相关，并且可以根据已知的分子间调控关系构建调控网络，然后告诉你哪些分子位于关键的节点。这个节点，术语 Hub gene，翻译成枢纽分子或者叫节点分子，换句话说就是提示你围绕哪些关键分子进行干预，可以有的放矢。通路网络的信息非常复杂，在你手握高通量数据要进行整体性分析时，这些工具必不可少。


第三类数据库是分子互作数据库，主要用在预测分子与分子间相互作用，也就是直接作用机制。


前面讲过 miRNA 预测靶基因的 Targetscan，预测转录因子靶基因的 JASPAR，其他还有很多，比如预测 lncRNA 与 miRNA 结合的 Starbase，蛋白与蛋白相互作用预测的 String 等等，各种分子类型相互作用都有数据库可以用。


大家注意，一旦涉及分子交互作用的预测一般同样的功能会有不同科学家开发好几个数据库，背后的算法逻辑和用法都有些差别，你一个个研究是很花时间的。


凡是我们推荐的，那都是公认好用的，是前人的经验和口碑，你没必要神农尝百草。


以转录因子的靶基因预测为例，除了 JASPAR 还有一个叫 TRANSFAC 的数据库，采用了另一种策略来做预测：集合了大量的 CHIP-seq 实验结果。什么是 CHIP-seq 呢？染色质免疫共沉淀 16 策讲过，如果把 CHIP 实验中通过抗体拉下来的转录因子-DNA 复合物，解离所有的 DNA 片段送去测序分析，就知道了一个转录因子结合的所有 DNA 序列，那就是 CHIP-seq，seq 就是 sequencing 测序的意思。转录因子毕竟数量是有限的，每个转录因子做一遍 CHIP-seq 不就掌握了大量实验来源的转录因子结合序列信息了吗？


这种基于真实实验数据的工具理论上比纯预测的可靠性要高一些，在有选择的情况下，不要忽略这一类数据库资源。


一些商业公司的网站往往也提供一些工具，比如 QIAGEN 公司提供了 CHIP 实验后 qPCR 验证的预设计引物，每个基因可能结合的转录因子都预测好了，连结合位点的预测结果都有，我是在 Genecards 数据库给的产品链接里发现的。还有 SIGMA 公司把所有基因的 shRNA 序列都给设计好了，并且是免费公开的，搞得设计 siRNA 这么一个有难度的活顿时没了技术含量。


最后还有第四类，也是最重要的一类数据资源：样本数据库。


之所以生信分析可以用别人的数据发自己的文章，别人的数据不是从文献一个个去找，而是有现成的数据中心，就是样本数据库。其中不得不提的典型是 GEO，GEO 是 NCBI 的一个子数据库，全称叫 Gene Expression Omnibus。这个数据库存储了全世界最大、最全面的基因表达谱数据，是个数据仓库。允许研究者上传自己的数据，也可以免费下载别人的高通量检测原始数据。全世界那么多实验室做高通量筛选，很多问题重复筛选是浪费的，允许研究者们共享数据是有利于科学进步的大好事。GEO 什么都有，是个大杂烩。各种常见疾病还有自己的样本数据库，比如做肿瘤的还有 TCGA、Oncomine、SEER，都允许我们根据自己感兴趣的问题下载高通量数据，经过二次分析产生新的结论，发表论文。


经常有学员问：我要做某某疾病，有没有数据库可以用啊？


我是授人以渔，不想每次帮你们捞鱼，所以这里把找数据库的索引目录的方法告诉你们，你们可以自己在里面寻宝。


第一个比较权威的数据库索引是牛津大学出版社的核酸研究杂志（Nucleic Acids Research，NAR），每年发布的数据库特辑（database issue），从 1994 年开始 NAR 就差不多每年要更新一版，当前已经是第 24 版了。NAR database issue 提供了 15 个分类的数据库目录，其中有一个就涉及按疾病找数据库。第二个再给大家介绍个数据库索引网站，叫 Omictools（https://omictools.com/），这个站点直接提供关键词搜索功能，用起来很方便，也可以按分类搜，每个数据库都有网址和简单介绍。不过数据库数量众多，很多作者发了文章之后没有维护基本就等于废了，如果有超过 5 年没有更新，是不是可用大家要加点小心。


在数据挖掘的过程中，统计方法可谓如影随形。


一般的流程，研究者会先通过高通量数据分析筛选出差异基因，然后会根据临床资料进行单因素、多因素和生存预后等分析操作。


在一些文章中，作者会把多个靶标根据评分组成多维度的分子预测模型，这种套路里样本数据至少会随机分成两份，一份 75%，一份 25%，或者七三分。


多的那份数据集用来建立预测模型，叫 Training set 训练集，然后另一个数据集测试模型，叫 testing set，测试集。


有些文章里还有第三份样本或者是自己的样本做外部独立验证，叫 validation set 验证集，由此证明模型的有效性。


除了建立多靶标的统计预测模型，还可以把有一定相关性的一组分子进行聚类分析，做分子网络，这里就用到 DAVID、KEGG 和 GSEA。所以纯生信套路本质上是利用数据库下载的高通量结果自己进行统计分析处理，再来点交互网络点缀的数据套路，各种分析手段需要融会贯通。


完整来说这套干的研究策略一共包含 4 个技能分支：第一个是系统搜索资料和荟萃分析的方法，如果你学过 META，这个思路是一样的。针对某一个问题，把所有已有的高通量数据 META 在一起，多份数据合并，这时候往往要求入组的数据采用同一个技术平台，或者用统计手段把它们的表达值标准化，让不同研究项目之间的数据可以进行整合比较。从单研究上升到多研究数据整合，其严谨性能得到提高。


第二个技能是把数据库里下载的数据做差异分析的方法，这里面最好是懂点 R 语言，会用一些软件。无论是你自己做高通量筛选还是用别人的数据，用到的技能是一样的，需要从芯片或者测序的原始数据转换到差异分子列表。


第三个技能分支是临床相关性的统计分析，主要是单因素，多因素，COX、logistic 回归，Pearson、spearman 相关系数等等，说起来简单，做起来需要注意很多细节，这些统计方法临床研究中也频繁要用到，必须要学。


最后一个技能分支——通路分析工具，跟差异分析差不多，是用一些现成工具，可以出一些炫酷的图。


这四种技能都学会了，你就是一个资深生信爱好者，虽然离专业选手还有一个编程语言的距离，你还不会自己编写工具，只能是用别人做好的工具来处理自己想处理的数据，但是不做湿实验，发干文章灌灌水已经毫无问题了。不过你都这么强大了，只是发点灌水文章有点亏吧？后面加上干湿结合，有生物学实验验证，你可以飞得更高。


干湿结合是说在你通过生信分析获得一组靶标的时候，不仅局限在临床相关性的统计分析，进一步可以选择其中有创新性的一个或多个，进行细胞、动物实验的表型验证。Gain of function，loss of function，证明这些分子之所以有表达差异，也有临床意义，是因为它具有某种影响疾病、表型的功能。接下来继续探讨分子机制，下游通路、靶点，找上游驱动因素，甚至直接筛选和验证相互作用的分子，这样逐步深入发展成一个多元变量的高水平文章。


我们换个角度看看文章数据堆砌过程中的构成要素，会对生信技能在基础研究中的价值有更好的理解。


当一个课题满足单变量有表型，数据有细胞也有动物，这就是个毛坯，想文章发得更高有 3 个方面的加分项可选：


第一，加生信分析，给这个分子套上一个怎么获得的理由，找数据库里的样本资料给你的结果做佐证，这可以加分。也就是说干湿结合并不一定就是从干的分析到湿的验证，有些人恰恰是先有了功能分子，然后反向往上找数据库验证，增加数据的说服力。


第二个方面，可以结合临床资料进行分层分析，有生存预后数据可以显著提升项目的临床意义，对文章的价值影响不小，也是医生做科研的一个优势。


第三个加分项是在机制上，特别是分子相互作用上精雕细琢，要知其然知其所以然。想象一下，一篇文章上来会有数据库前人研究的数据挖掘指明一个方向，然后会有自己样本的一系列验证，还有临床相关性的统计分析结果，提出临床意义，接下来是细胞动物表型和分子机制的实验结果，做通路或者分子调控的时候用一些数据库预测和进行网络构建，


除了间接机制还有直接靶点，靶点预测也会用到数据库再加上经典实验验证，这样的文章无疑有满汉全席的味道。


干湿结合之所以成为一种科研的趋势，是因为它确实给基础研究带来了解构问题的全面角度。


分析预测和实验验证是密不可分的整体，一般来说机制做得强的实验室生信能力并不一定也强，反之生信厉害的人一般做实验能力很弱，背后的原因是这些技能都需要花时间去修炼，你并没有比别人多出来的时间，所以两种技能都精通的人是稀缺的。


文章到了一定档次，常规的套路大家都会，不会的也有合作伙伴来补位，发顶级期刊还是需要提出具有颠覆性的创新观点才行，我只能指路，师傅领进门，未来修行靠个人。


今天是第三章「始制有名」收官的一策，我再带大家梳理一下这一路走来我们学习基础科研的思维递进层次。


我们在前三策提出疾、型、模、法、标的恒量套路，把医学科研的特性提炼出来，这是基础科研的第一层功力。一旦疾病和表型的组合确定，细胞动物模型、检测方法和分子标志物这些东西就是一套标准动作了。


基础科研的第二层功力就要领会变量的作用，我们在 456 三策介绍了分子、药物和通路三个常见的变量参数，变量加上恒量最简单的课题设计思路就有了，这是我们的第一章，纲领性提出了科研模块化拆解的方法。


第三层功力，知道了恒量中代入一个变量——分子就构成一个课题，分子就像是课题的种子，是课题 idea 的关键。种子从哪里来是这一层的关键技能，我们分享了一句经典口诀：要么筛，要么猜，这是 7、8 两策讲的，里面有很多经验是我自己经历过的或者是看到过的血的教训。


结合今天讲到的第四类样本数据库，你就会明白高等级的筛、猜手段就是运用好这些生信分析技能，资源在网上是现成的，只是你会不会挖掘的问题。愿意自己学就花个一年半载，没这个精力就找合作伙伴或者是公司来分析，解决了分子来源的问题 SCI 文章会源源不断。


接下来，我们要注意分子这个变量还有多变的形态，要擅于解除它的伪装，不管你怎么变，我火眼金睛都能识破，这算是第四层功力。


我们用 9、10、11、12 四策，具体解构了功能基因、miRNA、lncRNA 三类分子的研究套路以及分子修饰的常见模式。


到这里第一章恒量+变量的框架变得具体起来，有了详细的操作步骤，如果只是 3 分以下的 paper 灌灌水的话，学到这里就能玩得转了。这当中的一些实验细节，你对照着文献来理解是完全能快速进行实践操作的，大家可以配合套路课强化吸收。


入门阶段到第二章就结束了，第三章开始学习多元变量的体系，前面疾、型、模、法、标不能忘，变量分子的各种具体变化还要记着，然后变化再乘以变化，一个变量变成二元甚至三元，这就是第五层功力了。就像是练武打通任督二脉，到了第五层是另一片广阔的天地。如果这一关过不去，你的科研水平就只能停留在入门，看国自然需要仰着头看。


一旦掌握了分子下游靠通路，上游找转录调节因素这样的多元变量结构，你能驾驭的文章机制就深了，这种完整度的故事可以发到 5 分左右。


还有第六层功力，是我们第四章要重点探讨的内容——直接作用机制的具体模式。我们已经交代了 miRNA 结合靶基因如何验证的套路以及转录因子靶基因如何研究的规范，这才刚刚开始，分子交互是一场规模宏大的戏，需要更长的时间来领悟。


我用形容姑娘姿色的成语来概括一下这个层层递进的知识结构：


第一层，识别恒量套路，那是小家碧玉水平；


第二层，恒量变量组合，达到花容月貌，如花如月般美丽；


第三层，破解了分子来源，课题就滚滚而来，上升到沉鱼落雁的境界，鱼、雁都不敢争风采，比花和月更美；


第四层，洞悉分子变化，这般美色就叫国色天香，只不过以前的国比较小，相当于我们现在的一个省；


第五层，掌握多元变量，就到了倾国倾城，国家都因为美色要倾覆了；


最后第六层，突破分子的交互作用，有个词叫美若天仙，人间已经装不下了，会做直接机制已经是科研职业选手的水平持平，很高。这么多明星、网红，敢叫自己美若天仙的好像还真没有。


好的，第 18 策「利器侍之」，我们在这一讲提出了干湿结合的策略方法，并且告诉大家数据库的四种分类：信息类、通路类、互作类、样本类，前面三种之前都有提到过，这里我们需要特别关注样本数据库的「无中生有」的价值，没经费发 SCI 就靠它了。


从样本数据库找数据来挖掘是现在流行的生信套路文章的本质，要想跟上流行趋势需要修炼 4 项技能，整合数据、差异分析、统计分析、通路分析。


这一套技能练全了就相当于倚天剑、屠龙刀在手。


理论知识的内功修为与实验数据的外家招式合二为一，再有生信的传说级武器装备，试问天下，谁与争锋！上半部就这么厉害了，从下个段位开始，我们要进行第四章「用之不盈」的学习。


备案号:YX016g2YXnaA0jGv3


## 4.高精地图：常规 GPS 无法满足的精准定位，真正的自动驾驶如何实现？
一提到导航系统，首先映入脑海的，往往是各大知名的手机地图 APP（譬如高德地图、百度地图）。这些 APP 会实时读取城市的道路拓扑图，利用 GPS 定位用户的位置，然后规划路线，引导用户驾驶。那么无人驾驶出行在导航这一件事上，与人类的方式相同吗？


答案是二者既相同，又不同。


它们相同在有着一样的导航步骤：读取地图->定位汽车位置->产生最佳路线。


然而它们又有着根本上的区别：无人驾驶需要内容丰富的地图，更加精准的定位。那么我们的无人车为何有如此需求呢？


若想知道这内在的原因，就必须先大体知道我们口中常提到的「定位」到底是什么。 


一、全球定位系统
--------


**1. 全球导航卫星系统**


全球导航卫星系统（GNSS）是一套基于卫星的全球导航定位系统。首先，作为导航定位系统，它能为用户提供可用范围内的地球表面或近地空间的任意位置的 3 维坐标和速度以及时间信息。这就要求在可用范围内的任何时间、任何地点都能观测到 4 颗以上的卫星。 


其次，全球导航卫星系统意味着全球范围的服务能力。现在世界上能提供全球范围的导航定位服务的只有 4 个系**统：中国北斗, 美国 GPS，俄罗斯 GLONASS 以及欧盟 GALILEO。**


全球导航卫星系统通常包含 3 部分：空间部分、地面监控部分以及用户部分。


**空间部分**的主体即导航卫星。**地面监控部分**主要工作就是跟踪、监控导航卫星，搜集数据并对卫星发送一定的控制指令。而**用户部分**，对于驾驶场景，就是车载的 GPS 信号接收器了。GPS 接收器在能同时接收到 4 颗卫星信号时，可以提供车辆本身的 3 维坐标。


不同的系统会给出不同坐标系下的 3 维坐标。通常在导航卫星系统中，用的都是地心坐标系，也称地心地固坐标系。地心坐标系是以地球质心作为原点的坐标系。例如 GPS 采用的是 WGS-84 坐标系，而中国北斗采用 BDCS 坐标系，另外还有经常能听到的 2000 国家大地坐标系（CGCS2000）。这些坐标系都是地心坐标系。不同的坐标系之间会有一定的转换关系，可以互相转换，甚至在对精度要求不高的场景下可以直接替换使用。例如 GPS 坐标系和北斗坐标系，在驾驶场景下完全可以互相代替。两者在同一点的坐标差异小于 0.105mm[[1]](#ref_1) 。


![img](https://pic4.zhimg.com/v2-91363416c836290e5553ee1e670a83f7.webp)

**2. GPS**


我们以 GPS 为例，来具体说说全球导航卫星系统的定位原理。


GPS 包含 24 颗卫星，分布在 6 个轨道面上。保证在全球任何地方、任何时间都可观测到 4 颗以上的卫星，并能保持良好定位解算精度的几何图形。**根据距离交会法，至少需要同时看到 4 颗卫星，才能实现 3 维坐标的定位。**


GPS 定位最常见的是伪距单点测量，也就是我**们最熟悉的时间乘以速度等于距**离。这里有两个端点，起始点是卫星，终点是 GPS 接收机，即装有 GPS 车载系统的车辆。**时间是卫星发射的测距码信号到达 GPS 接**收机**的传**播**时间**， **速度**是**光速**，这样我们就能得到**卫星与车辆之间的距离**。任一时刻，需要车辆与 4 颗不同卫星之间的伪距，外加从卫星导航电文中获得的卫星瞬时坐标，采用距离交会法，就可以得到车辆在 WGS-84 坐标系中的三维坐标。


![img](https://pic3.zhimg.com/v2-831d94a1573736b4e89e257518e38e9f.webp)

GPS 存在三部分的误差，第一部分是所有 GPS 接收机都有的，如卫星钟误差，星历误差、电离层误差、对流层误差等， 第二部分是传播延迟误差， 这两部分的误差都可以消除。第三部分是所有 GPS 接收机的固有误差，如内部噪声等，这部分误差无法消除。


**3. 传统导航地图**


通过上述技术，我们就可以知道自己在全球坐标系下的三维坐标了。但只知道 3 个数字，是无法满足我们日常的导航需求的。在传统导航中，通常我们想知道自己和周围的标志建筑的位置关系，或者周围道路的分布情况，到达某一目的地的路径等。这些信息都需要从电子地图中获得。


电子地图是基于某一选定的坐标系绘制的地图。通过将从导航卫星系统中得到的坐标信息反映到地图上的点，可以完成在地图中的定位。


国内的地图制造商有四维图新、高德、道道通等。它们有相当数量的外业人员，以开车或步行的方式穿梭在大街小巷。随身携带的 GPS 终端，会记录下他们经过的轨迹，再通过软件整合，最终点绘成线，线绘成整个城市庞大的路网。除此之外，采集人员也会在系统中录入兴趣点（POI，Point Of Interest），通常包括一些标志性建筑物、办公大楼、商店商场等。


虽然传统的导航地图有着完整的道路拓扑结构，但是它能提供的信息都很粗略。比如它不会告诉你车道线所在位置，不会对周围的建筑有精准的描述， 也不会告诉你交通信号灯的准确位置，而这些缺失对于无人车的安全行驶是致命的，因为它需要高精准的定位。 


二、为什么无人车需要高精准定位？
----------------


经过上一部分的叙述，我们大概知道了普通的 GPS 与导航地图的两大问题：误差过大、地图信息过于简略。


这两点对于我们人类来说还是在可容忍的范围之内。比如地图上虽然没有显示车道线与交通灯的信息，但是我们的双眼可以清晰地看到车道线的位置，我们的大脑可以帮我们通过车流速度很好推测出前方是否有红灯，所以当我们收到指令下个路口右转时，会很轻而易举地从最左道变到最右道，并且根据交通灯来决定右转的时机。


然而对于无人汽车来说，在复杂的交通环境和恶劣的天气下，识别上述信息是具有困难的。


举个例子，在交通拥堵时段，驾驶员被要求从最左道变道最右边，然而此时，四周的车道线已经被遮掩地十分严重。对于人类来说这并不是问题，因为我们的大脑可以推断出自己在第几车道，但是无人车却无处获得自己到底在第几条车道线的信息，这就可能导致驾驶出现安全隐患。


再举一个例子，假设道路一侧的「车辆慢行」指示牌经过了风吹日晒，磨损严重，那么无人车的识别系统便很难辨认，导致它照样高速行驶，极有可能造成车祸。


**所以无人车要解决常规定位的两大难题，便需要「精准定位」。**这里的精准定位指的不仅是需要高精度、厘米误差级的 GPS，更是需要一张特制地图。


试想一下，如果这张特制地图含有上述的车道线和指示牌的信息，那么无人车除了自身的 GPS 定位系统，是不是也可以通过自身的视觉系统来匹配地图里的信息，从而得知自己的高精准位置？


如此一来是不是无论在任何恶劣的情况下，无人车都更容易做到「靠谱行驶」？


事实上，这种做法已经被工业界广泛引用，而这张特制地图便是大家常提到的**高精地图**。 


**三、到底什么是高精地图？**


高精地图，故名思义，是比传统的导航地图更高精的地图。其高精即体现在更高的绝对坐标精度，也体现在更多更丰富的信息。


![img](https://pic1.zhimg.com/v2-13a516a5c737818415a148f74825252e.webp)

精度方面，传统导航地图通常精度大约为米级或 10 米级左右，而高精地图的坐标精度可以达到亚米级甚至厘米级。坐标的绝对精度会直接影响到定位精度。


传统导航地图通常只提供路网结构信息和粗略的几何点位置。而高精地图除了这些信息外，还会包含三维的点云信息，以及更高级别的语义信息，如车道信息（车道线位置、类型，车道方向、车道交通限制信息等）、交通标志信息以及红绿灯、立交桥、龙门架等的位置信息。


**那么高精地图一般是如何制作的呢？**


制作高精地图最重要的两个步骤是**采集**和**数据处理**。不同于传统的电子地图制作，高精地图需要更多更高精度的传感器来完成采集，包括激光雷达、多摄像头系统、惯性测量系统以及定位系统等。配备了这些传感器的采集车会在需要采集的区域中穿梭，采集大量道路及周边环境的数据。


在采集到这些数据后，还要对这些信息进行处理，包括对数据的清洗、不同传感器的融合以及语义信息的识别和标注等。这部分的工作是相当繁琐的。不仅需要程序及 AI 的帮助，也不可避免大量的人力投入。


**通过这部分介绍，我们知道了高精地图的重要性，然而高精地图若想有用武之地，首先需要知道车辆的精准位置。**虽然许多无人汽车配套了高精度的 GPS，但在很多时候 GPS 依然有可能失效。比如车辆高速行驶时，GPS 的更新速度可能无法完全跟上，再譬如附近有高楼大厦遮挡时 GPS 的精度也会受到重大影响。为了应对这些情况，无人车往往会在 GPS 定位的基础上，再利用视觉识别系统与高精地图的内容进行匹配，来实现真正高精的定位。


**四、高精地图怎么用？**
--------------


通常 GPS 的定位精度只能到达米级甚至 10 米级。如果定位精度不够，那地图精度再高也没有意义了。因此，无人车会首先利用传统 GPS 在高精地图中得到大致位置。然后再利用感知系统，识别周围环境，与高精地图中的信息进行匹配，修正 GPS 定位的结果，来实现亚米级甚至分米级的定位。定位精度取决于感知精度以及高精地图本身的精度。


这里的感知系统一般为激光雷达或者摄像头系统。若使用激光雷达，则能得到周围的环境的点云信息，从而与高精地图的点云进行匹配。


![img](https://pic2.zhimg.com/v2-5a4cc9952e867a5e683e51d710c8a7ec.webp)

若使用摄像头系统，则会提取更高级别的语义信息来进行匹配定位。包括车道线、地面箭头、交通标志、电线杆和龙门架等。通过识别路面的车道线，可以判断车道数，以及自车所在的车道位置，然后再从高精地图中提取对应车道的信息，如车道方向、车道线类型等。


![img](https://pic3.zhimg.com/v2-378201510b3ecbdbbf44e3a859856587.webp)

由于视觉检测及深度估计的局限性，通过摄像头的定位通常要低于激光雷达的定位精度。但成本也要低很多。


经过上述的内容，我们了解到高精地图可以说是无人驾驶的安全卫士与指路明灯，然而它本身有着巨大的问题：**传统制作高精地图价格极其高昂**。 高昂的采集设备和人工费用，让高精地图的制作成本可能达到上亿人民币。


**为了解决该问题，工业界提出了新的解决方案——众包地图。**


**五、众包地图**
----------


高精地图长久以来没有广泛推广，一方面是受制于制作成本高，覆盖率有限，另一方面是无法及时更新道路信息。为了解决这两个软肋，近年来众包地图的概念被提出。所谓众包地图，即利用群众的力量，让每辆在路上跑的车都提供一部分信息，通过整合这些信息来得到或更新高精地图。


![img](https://pic2.zhimg.com/v2-a4223a4e52e873f1b15ec2b58270468d.webp)

每辆车内的传感器都会回传一定的数据，用于地图厂商在服务器端生成高精地图。回传的数据可以是原始的 3D 点云图，也可以是已经处理过的语义信息。但由于有成千上万辆车在路上跑，所以同时回传的数据量会非常大，所以一般会在车辆终端的处理器上先对生图进行实时处理，提取语义信息之后，再回传。


提取的语义信息包括上文提到的各类定位标志物。如果有 10 辆车，100 辆车都说某个路口有禁止掉头标志，但高精地图上却没有，那么大概率那里刚竖起了一块禁停标志。


众包地图就是通过这种方式，不断地实时更新高精地图。当然，对于某一图商而言，实现众包地图的前提是，有足够多的搭载其传感器的车辆在路上跑，例如 Mobileye 和 Tesla。


六、总结
----


高精地图的应用在无人车领域已是一大趋势。伴随而来的便是基于高精地图的各种解决方案。如何更精准地在地图中定位，如何更大程度地利用高精地图，以及如何降低高精地图的成本，使之形成更完整的生态。这些都是亟待解决的问题。但无论如何，高精地图都无疑是一条值得期待的通往无人驾驶的途径。


备案号:YX01APK9jDXMmP4pY


参考
--

1. [^](#ref_1_0)测绘精选 WGS84、BDCS 与 CGCS2000 <https://www.sohu.com/a/359656655_120435367>

## 90.量子场论
量子场论（Quantum Field Theory，QFT）是量子物理学的基础理论，在无数的经验证明中得到了广泛的认可，成功地重新解释了量子力学。它将粒子视为场上的激发态，即所谓的量子，而粒子之间的相互作用则是以相应的场之间的交互项或费曼图来表示，这些图成为用于计算粒子交互过程的重要数学工具。 


「场」的概念可以很直观地来描述，如一个电磁场被定义为时空的一种属性，可以用标量、矢量、复数等来表示。因此，QFT 将场的激发态定义为能量大于基态的任何状态，如光子是电磁场的一种激发态。 


#### 规范场论与球形曲面卷积


传统摄像头是对有限的 3D 场景采样，并投影到 2D 平面上。而 360° 全向摄像头围绕其光学中心的整个观察球体场景进行采样，提供视觉世界的完整画面——全方位视野视图。360° 图像提供了更加身临其境的视觉内容体验。 


这种摄像头摄入的不仅有球形曲面物体，还包含无人机、机器人、自动驾驶汽车、VR/AR、3D 游戏的多台摄像头等旋转的物体摄入的 360° 全向视觉，360° 图像被投射到围绕摄像头光学中心的单位球面上。此外，球面和曲面图像数据还常常出现在医学成像、蛋白质分析、天体物理学、全球气候预报等重要领域。 


卷积神经网络（CNN）可以处理各种视觉任务，包括图像识别、物体检测、图像分割等。然而，到目前为止，现有的 CNN 都是基于作用于平面上的普通卷积，它的训练数据和卷积核都是透视投影到平面的产物，不能理解和处理球形曲面物体的图像数据，也不能处理旋转的图像。例如，如果把一部汽车或一张人脸旋转一个角度，CNN 就无法识别出来。现有的 CNN 也无法有效执行三维物体表面识别、弯曲表面上图像或文字的识别等任务。 


一些研究人员提出了解决方案，用几何 CNN、球面 CNN 等一些方法来帮助 CNN 应对复杂图像的处理，包括识别和分类，但是几何转换相当烦琐和费时。当以某种模式在球面上移动时，必须处理 3D 旋转而不是像在平面情况下的简单平移。球面信号的旋转不能通过对平面投影的平移来模拟，因为会导致错误和严重失真。 


把规范场论（Gauge Theory）的等变原理应用到 CNN，是解决这一问题的一条有效途径。高通的 AI 研究人员塔科·科恩（Taco S. Cohen）等提出了一种基于规范场论的新型 CNN，即规范等变 CNN（Gauge Equivariant CNN，G-CNN）  [269]  。该模型可接收几乎所有曲面物体数据，并将新型卷积方法应用于这个神经网络。 


规范场论是量子场论的一种，也是当代物理学最前沿的阵地之一。如麦克斯韦方程所描述的，电动力学是规范场论中最常被引用的例子之一。在电动力学的场方程中，电场 E（t，x）和磁场 H（t，x）被分别表示为一个标量场 φ（t，x）（标量电势）和一个矢量场 A（t，x）（矢量磁势）。电磁四维势（Electromagnetic Four-Potential）A  μ  =（φ, A）是电磁理论中的一个协变四维矢量，它以比电场和磁场本身更基本的角度来描述电磁场。A  μ  是协变的，这意味着它在任意的曲面坐标变换下都和一个标量的梯度变换方式相同。这样四维势的内积在任意惯性系下都是一个不变量。但是，电场与磁场和相应的标势与矢势的对应关系并不是唯一的，通常可以对这两个势作如下的变换： 


![img](https://pic3.zhimg.com/v2-c942f5f92f3fa17fd05db417cfa57aca.webp)

这组变换称为规范变换，在规范变换下电场 E 和磁场 H 仍然保持不变。这本质上是对称性质，即规范不变性的一个例子。 


规范场论主要基于对称变换，可以局部也可以全局地施行这一思想。一个物理系统往往用在某种变换下不变的拉格朗日量表述，它要求拉格朗日量必须也有局部对称性——应该可以在时空的特定区域施行这些对称变换而不影响到另外一个区域，在连续对称变换（规范变换）下保持不变。 


规范变换的一个简单例子是温度测量，如在中国使用摄氏温度，而在美国使用华氏温度，这就是两种不同的规范。当以华氏温度测量时，我们得算出它对于摄氏温度的含义，因为有两个不同的参考系，这种计算就可称为规范变换。而这时的实际温度并没有变化，只是我们用来理解的值发生了变化，而且规范变换是一个简单的线性函数。 


这种对称性或规范不变性是为介质及光学变换中的电动力学建模的指导原则。这意味着可以以一种固有的协变方式来表达麦克斯韦方程组，从而可以独立于坐标系选择而在流形（manifolds）  [[1]](#note_1)上描述电磁现象。这个原理对于设计一种等变 CNN 非常重要。 


球面 CNN 的旋转不变性必须具备在给定空间内的全局对称性，这对应于物理学中通常所指的时空不变性。而规范等变 CNN 是针对局域对称性所提出的。一般流形确实具有局部规范对称性，如果想要构建仅依赖内在几何的流形 CNN，考虑这些不仅是有用的而且是必要的。为此，科恩等人在普通流形 M 上定义了类似卷积的运算，它与局部规范变换保持等变性。 


如果考虑在一个球体表面均匀放置很多个指南针，每个指南针的指向都是一个矢量，称为矢量场。如果测量的时候使用了不同的局域坐标系（不同的规范），那么测得的每个矢量的指向随规范而变化。如图 16.1 所示，一个规范是在一个流形 M 的子集 U 上的切线标架的局域坐标系。球面是个流形 M，U  1  是蓝色箭头下的局域空间（蓝色规范），U  2  是红色箭头下的局域空间（红色规范），弯曲流形 M 的局域可以近似看作平直，如平直拉伸后的 V  1  和 V  2  。待测矢量在 U  1  和 U  2  规范下，位置、方向、模长都不同。如果蓝色和红色规范之间的变化保持等变，就满足了局部规范变换的等变性。 


![img](https://pic2.zhimg.com/v2-ecd587eb160b3ea14bcefb6826047cf5.webp)

规范需要用几何量来表示，如卷积核和特征图（即场，类似于物理学中的物质场）。规范等变卷积以各种类型的 M 上的多个特征场作为输入，并产生作为输出的新的特征场。每个场由许多个特征图表示，它们的激活可以看作相对于空间变化的坐标系（即规范）的几何对象（如标量、矢量、张量等）系数。因此可以建造一种网络，使得如果变换规范，系数则以可预测的方式改变，以便保持其几何意义。这种类似卷积的运算应该是规范等变的，意味着 CNN 应该能够识别输入坐标系到输出坐标系的任何变换的影响。这种规范等变性，也是流形卷积的一个关键几何定义，即确保输入矢量的规范变换会导致输出矢量的等变变换（即相同的变换，但具有不同的表示形式）。 


实现规范等变的方法是首先为流形的子集任意选择一个光滑的局域规范，比如图 16.1 中蓝色箭头定义的局域规范。从任何一个点出发，可以像平面卷积一样定义一个卷积核及卷积核的朝向，并将其与局域的输入特征图（即场）匹配点乘，从而计算出输出特征图。这就实现了局域卷积，但为了让输出满足等变性，还必须对卷积核作一些线性约束。 


一般来说，流形不具有全局对称性，但是它们可能具有某些局部对称性。但是科恩等人把规范等变网络用于一个特定的流形例子——20 面体。20 面体是具有 20 个面、30 条边和 12 个节点的传统实体。20 面体的每一面都是平直的，但整体又是很好的球形近似。这种流形具有一些全局对称性（离散旋转），很好地体现了局部对称和全局对称之间的区别和相互作用。而使用现有的深度学习方法可以有效地实现该流形的规则性和局部性。这种算法在全向信号的分割方面表现出优异的性能和准确性。与球面 CNN 模型相比，规范等变 CNN 模型的最大优势在于，它摆脱了球面 CNN 模型对于全局对称性的假设，只要在局域上近似地具备对称性，它就可以将广义相对论规范场论的数学工具及相应结论借用到这个模型里。 


为了有效处理球形曲面图像，过去还有一种预处理的方法，即先把球面图像转换成普通的平面图像，然后进入 CNN 进行处理。曾有公司设计过类似功能的专用曲面预处理芯片。然而，这种芯片在处理分辨率很高的图像时，难以应付高度实时性。而规范等变 CNN 从本质上解决了这个问题，这是 AI 芯片设计由基础理论所指导、从理论上突破的一个例子。 


另一个值得注意的方面是规范场论已经很好地用于物理学、数学、经济学、金融学和生物学等，可以从自由能（Free Energy）原理角度来表述。在生物学和神经科学中，自由能原理提出了一种适用于任何自组织系统的统一的行动、感知和学习，及如何与环境保持平衡的理论。在这种情况下，系统相当于具有拉格朗日量（反映神经元或内部状态）的大脑，而环境（具有外部状态）产生局部感知扰动（表现为局部对称性被破坏或发生了规范变换）。注意力、感知和行动都可作为规范场来补偿，恢复拉格朗日量的对称性  [270]  。如果这种原理适用于大脑或神经系统，它也可能适用于 AI 系统，作为一种开发未来 DNN 的理论基础。 


#### 重整化群与深度学习


重整化群（Renormalization Group，RG）  [271]  作为一种最终成型于 1970 年左右的技术，背后隐含的思想（重整化）可以说是近代物理学在观念上最重要的突破之一。重整化（Renormalization）起源于量子场论，目的是希望路径整合的结果保持标度不变。在凝聚态问题中，一般很关心系统何时处于标度不变（自相似/分形/临界）状态，因此重整化群概念发展了起来。 


重整化群是一个在不同尺度下考察物理系统变化的数学工具。它是一种迭代式的粗粒度处理过程，旨在解决涉及许多尺度的困难物理问题。目标是通过整合（即边缘化）短距离自由度来提取物理系统的相关特征以描述大尺度的现象。在任何 RG 序列中，从原子涨落的微观尺度开始依次整合物理波动，然后迭代移动到宏观更大尺度的波动，直到所有尺度的波动都被平均为止。在此过程中，某些称为相关运算符的特征变得越来越重要，而被称为无关运算符的其他特征对系统物理属性的影响越来越小。也就是说，在当前观测尺度下对不需要关心的细节模糊处理，最终得到一个简单的模型。 


重整化群提供了一套复杂且精巧的近似方案来系统地描述一个非常复杂的物理学系统。这是一种粗粒子方案，即跨过距离尺度，一步步放大相关的细节，紧扣其影响大尺度行为的要素，同时模糊无关的细节，最后精炼出系统的基本部分。它使得物理学家无须知道所有组成成分的精确状态，就可以准确地描述大尺度系统。 


美国的两位教授研究发现，深度学习领域里的提取相关特征，与重整化群的系统描述方案，在本质上就是一回事  [272]  。人们在理论上仍然没有很好地理解为什么深度神经网络（DNN）在揭示结构化数据中的特征方面如此成功。然而，一个可能的解释是它们可以被视为连续迭代的粗粒度方案。DNN 的初始层可以被认为是低级特征检测器，然后被送入 DNN 中的更高层，将这些低级特征组合成更抽象的更高级特征。通过连续应用特征提取，DNN 学会使数据中不相关的特征变得不重要，同时学习数据中相关的特征。 


对于 DNN，常用的是监督式网络，而另一类是无监督网络，其中包括 RBM 之类的模型。RBM 是一种特定类型的 DNN，由两层神经元组成。可见层接收输入样例，另一个隐藏层构建输入的内部表征。为了提高计算效率，每层中都没有横向连接，因此它们被称为受限。RBM 可以模拟热系统的 RG 粗粒化过程。 


已经有研究人员证明在基于 RBM 的 DNN 和重整化群之间存在着精确的一对一映射关系  [272]  。而对于深度学习原理与量子场论之间存在的相似性，也有研究人员进一步用数学作了详细推导  [270]  。这种相似性表明，DNN 的原理深深扎根于量子物理学中，显示出与量子场论原理的对应关系。 


近来有研究人员提出，在量子系统（如矩阵乘积状态和张量网络）的背景下开发的现代 RG 技术在变分 RG 方面具有自然解释  [273]  。这些新技术利用了纠缠熵和解缠结之类的想法，这些想法创建了具有最小冗余量的特征。这些想法是否可以导入深度学习算法，还是一个有待探讨的问题。 


物理学家已经开发了精密的机制，利用 RG 的一些基本概念来识别物理系统的微观和宏观特征，这与生物大脑的学习机制也是非常接近的。我们人类掌握了特殊的诀窍，能够分辨出人群中一张熟悉的面孔，或分辨出面前被各种颜色、轮廓、质地所混淆的任意目标。这种学习过程表明，大脑也采用了某种形式的重整化群来理解世界。 


重整化群、深度学习和生物大脑的学习过程的相似性，还需要进一步深入研究并形成简化的数学模型。如果能够有任何简化复杂机制的模型导入深度学习中，将可以为深度学习技术提供一个全新的视角，也会为未来的 AI 芯片开发带来新的思路。不过，将量子场论和 RG 的想法引入深度学习技术领域存在着潜在障碍，即 RG 通常应用于具有许多对称性的物理系统，而深度学习通常只与结构有限的数据相关联。 


总之，作为量子科学基础理论的量子场论，正在受到 AI 研究人员的重视，主要是因为其潜在作用：量子场论提供了一种坚实的理论基础来解决目前深度学习所遇到的瓶颈，为找到深度学习内部机制的明确解释提供了一种理论根据。同时，它也能为下面讲到的基于复数运算的 DNN 带来一定帮助。 


备案号:YX01jbkWgwB9w7Lle


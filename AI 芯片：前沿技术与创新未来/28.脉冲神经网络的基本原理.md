## 28.脉冲神经网络的基本原理
脉冲神经网络使用脉冲的方式与生物神经元类似。除了神经元的状态和突触权重之外，SNN 还将时间概念纳入到它的操作模型中。在这些神经元中，没有固定的传播周期，因此每个神经元仅在其状态达到特定阈值时才发出输出峰值。因此，这些网络中的信息流是脉冲序列，在神经元之间异步传播，并且脉冲之间的时间相关性至关重要。 


让我们先来看一下生物大脑的机制。生物神经细胞（神经元）的细胞膜在没有受到刺激的时候，细胞膜内外两侧存在外正内负的电位差，形成一定的电位。当诸如钾和钠之类的离子通过通道进入或离开时，神经元会改变细胞膜电位。膜电位与离子电流的关系具有非线性特性，当超过一定的阈值时，输出是非常窄的脉冲，启动这种脉冲常被称为激发（Fire）。神经元通过被称为突触的连接进行连接，当从另一个神经元输入脉冲信号时，会在神经元内部产生与突触的连接权重相对应的效应（突触后电位），并且将被添加时间印记。 


神经元内部和包括离子通道在内的突触具有非常明显的非线性特征，但是，在 SNN 中，这些细节被简化成一个简单明了的模型，如图 5.1 所示。一个神经元有许多输入脉冲，并在超过触发阈值时输出一个脉冲。从图上可以看到突触电位随着时间会有一定衰减，这是考虑了电路里 RC 时间常数的漏电效应，因此这个模型被称为漏电整合-激发（Leaky Integrate-and-Fire，LIF）模型，是目前使用最多的一种基本模型。根据对生物保真度的模仿程度，现在研究人员已经又提出了一些新模型，本书不再赘述，有兴趣的读者可自行查阅。 


![img](https://pic3.zhimg.com/v2-d336a71c399fce356457684d0853d1d4.webp)

典型 LIF 神经元的膜电位随时间的变化如图 5.2 所示。当脉冲输入神经元，即 x  i  （t  1  ）=1 时，与该脉冲相关的突触权重 w  i  将在膜上整合。当膜电位 V  m  超过阈值 V  t  时，神经元激发（即 y  i  =1）并重置其膜电位。对应于生物神经元，这里还特地设计了一个「不应期」（即没有任何反应的时间段），如果未达到不应时间 T  r  （即自最后一个输出峰值以来的时间量小于 T  r  ），则即使其膜电位高于阈值，神经元也不会给予反应（激发）。另外，由于漏电，在两个输入脉冲之间的膜电位会根据漏电率连续降低。 


![img](https://pic3.zhimg.com/v2-e1a2b47cd90f9bc0315c1fd499d288fb.webp)

从图 5.2 可以看到，神经元异步接收到多个脉冲，复位将电位重置为零。在不应期时间段内会禁止神经元脉冲，直到两个脉冲之间经过了足够的时间。 


LIF 神经元的基本参数是膜阈值电压、复位电压、不应期和漏电率  [71]  。在每个时间点 t，第 l 层的神经元 j 的膜电位 V  m  可以描述为 


![img](https://pic4.zhimg.com/v2-68d26fae17fd9534eb4ea2a51b4f2795.webp)

式中，参数 λ 对应于泄漏，w  i  ,  j  是突触增强。注意，可以使用包括复杂内部机制的模型来定义这些参数，而不是恒定的标量值。 


将给定时间步长的所有输入脉冲整合后，将电位与阈值进行比较，并通过以下方式定义输出： 


![img](https://pic1.zhimg.com/v2-06a068176c17c4f6e8701807708518f9.webp)

式中，t  s  p  i  k  e  是第 l 层神经元 j 发送信号的最后时间点。可以按照不同的方案执行重置：将电位重置为恒定值 V  t  或从当前膜电位中减去重置值。 


就生物动力学而言，LIF 神经元模型已经是一个简单的模型，但并不是最简单的模型。如果不是一定要与生物机制一一对应起来，设计人员可以使用抽象模型来减少硬件资源。例如，IF 神经元就是 LIF 的简化版，它把原来的不应期和漏电机制都消除了。在芯片实现时，必要的电路模块仅是用于整合的加法器、用于阈值检测的比较器和用于膜电位存储的存储器  [72]  。 


在 SNN 中，脉冲用单比特（0 或 1）来表示。带有二值脉冲的信息表示允许使用模拟或数字硬件忠实地实现这些系统。为了对神经网络的输入进行编码并读出其输出，需要了解如何使用脉冲来表示复杂信息。然而，SNN 中的信息表示仍在讨论中。图 5.3 描述了用脉冲表示信息的不同方法。大多数 SNN 使用通常称为频率编码的方法，神经元之间传输的信息使用在一定周期内发出的脉冲平均激发频率来表示，是一种频域编码方式，通常使用泊松脉冲序列，在这种情况下，连续脉冲之间的精确时间是随机的，但脉冲的总频率是固定的。 


这种频率编码不能从 SNN 处理所具有的脉冲稀疏性中受益，因此，它无法实现脉冲编码的稀疏性相对应的低功耗通信和计算；常被期望的 SNN 快速计算能力也很难达到，因为这种编码在输出激发频率的计算中引入了时延。也有人用实验证明了这种编码方式在生物学上的不合理性。 


然而，还有许多其他生物学上可行且更有效的编码策略。一些神经科学家提出大脑中的部分信息是以时间方式编码的。时域编码可以几种形式实现：有人使用首次脉冲时间（Time To First Spike，TTFS）  [73]  ，其中激活强度与神经元的激发时延成反比，即具有最高膜电位的神经先「激发」；有人提议使用脉冲间间隔（Interspike Interval，ISI），即连续脉冲之间的精确时延来对激活强度进行编码  [74]  。还有人提议只按照脉冲的顺序对相关值进行编码，称为等级编码  [75]  。 


自 20 世纪 80 年代以来，研究大脑机制的人员已经意识到使用脉冲模式进行信息表示的重要性。后来，许多研究人员认识到每个脉冲都是有意义的，总结了脉冲时序依赖可塑性（Spike Timing Dependent Plasticity，STDP）。突触强度根据脉冲时序发生变化的发现是一个重大研究成果。 


STDP 是一种机制，当连续的脉冲信号之间的时间间隔较短时，突触连接被增强，而在时间间隔较长时，连接强度会被减弱。当信号紧密对齐时，连接变得更强，但过一会儿就会「忘记」。因此，可以提取时间相关性。 


![img](https://pic2.zhimg.com/v2-d662608e869d25baec01a1c086ce331b.webp)

如图 5.4 所示，前级神经元 j 和后级神经元 i 之间的突触连接权重变化 Δw  i  j  取决于每个输出脉冲的时间差 Δt。在非对称类型中，当前级神经元脉冲在后级神经元脉冲之前到达突触部分时，连接权重（连接强度）增大，而在之后到达突触时，连接权重减小，并且可能是负值。突触强度的这些变化被认为在人脑的学习和记忆中起着重要作用，称为学习因果关系。那种使连接权重减小的非因果信号会加以抑制和消除，以节省功耗。另一方面，对称类型取决于脉冲时间差的绝对值。 


![img](https://pic2.zhimg.com/v2-6afa44498650d91f9cc5a16953aef75a.webp)

脉冲信号会根据信号之间的时序削弱与神经元的连接强度。在脑神经学领域，发送此类信号的突触被称为抑制性突触，反之，加强连接的突触被称为兴奋性突触。这是现有 DNN 所没有的功能。 


备案号:YX01jbkWgwB9w7Lle

